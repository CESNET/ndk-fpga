<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Rate Limiter &mdash; Minimal NDK Application Docs  documentation</title>
      <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/css/theme_overrides.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="Packet Delayer" href="../packet_delayer/readme.html" />
    <link rel="prev" title="MFB Enabler" href="../enabler/readme.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../index.html" class="icon icon-home">
            Minimal NDK Application Docs
          </a>
              <div class="version">
                Git branch: devel, <br> Git hash: c0ae043c
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Application:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../app-minimal.html">Minimal NDK application</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Network Development Kit:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../ndk_core/doc/how_to_start.html">How to start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../ndk_core/doc/terminology.html">Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../ndk_core/intel/readme.html">NDK architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../ndk_core/doc/configuration.html">Configuration files and parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../ndk_core/doc/testing.html">NDK testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../build/readme.html">Build System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../ndk_core/doc/devtree.html">Device Tree</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Supported cards:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../ndk_cards/agi-fh400g/readme.html">ReflexCES XpressSX AGI-FH400G</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../ndk_cards/dk-dev-1sdx-p/readme.html">Intel Stratix 10 DX FPGA DK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../ndk_cards/dk-dev-agi027res/readme.html">Intel Agilex I-Series FPGA DK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../ndk_cards/fb4cgg3/readme.html">Silicom fb4CGg3&#64;VU9P</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../ndk_cards/fb2cghh/readme.html">Silicom fb2CGhh&#64;KU15P</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../ndk_cards/ia-420f/readme.html">Bittware IA-420F</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">VHDL components:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../base.html">Basic Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ctrls.html">Controllers &amp; TSU</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../mi.html">MI Tools</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../mfb.html">MFB Tools</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../readme.html">MFB specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reconfigurator/readme.html">MFB Reconfigurator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../frame_unpacker/readme.html">Frame Unpacker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../splitter_simple/readme.html">MFB Splitter Simple</a></li>
<li class="toctree-l2"><a class="reference internal" href="../splitter_simple/readme.html#id1">MFB Splitter Simple Gen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../merger_simple/readme.html">MFB Merger Simple</a></li>
<li class="toctree-l2"><a class="reference internal" href="../merger_simple/readme.html#id1">MFB Merger Simple GEN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cutter_simple/readme.html">MFB Cutter Simple</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dropper/readme.html">MFB Dropper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metadata_insertor/readme.html">Metadata Insertor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transformer/readme.html">MFB Trasformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pipe/readme.html">MFB PIPE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../merger/readme.html">MFB Merger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../splitter/readme.html">MFB Splitter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../splitter/readme.html#id1">MFB Splitter Gen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../enabler/readme.html">MFB Enabler</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Rate Limiter</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#operation">Operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#address-space-and-configuration">Address space and configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../packet_delayer/readme.html">Packet Delayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../timestamp_limiter/readme.html">Timestamp Limiter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../loopback/readme.html">MFB Loopback</a></li>
<li class="toctree-l2"><a class="reference internal" href="../crossbarx_stream2/readme.html">CROSSBARX STREAM2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../frame_masker/readme.html">MFB Frame Masker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../logic/crossbarx_stream/readme.html">CrossbarX Stream</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../logic/checksum_calculator/readme.html">Checksum Calculator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../logic/auxiliary_signals/readme.html">MFB Auxiliary Signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../storage/pd_asfifo/readme.html">MFB Packet Discard ASFIFO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../storage/asfifox/readme.html">MFB ASFIFOX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../storage/fifox/readme.html">MFB FIFOX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../storage/crossbarx_output_buffer/readme.html">Crossbarx Output Buffer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../debug/gen_loop_switch/readme.html">Gen Loop Switch (GLS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../debug/generator/readme.html">MFB Generator</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../mvb.html">MVB Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../nic.html">Network Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../pcie.html">PCIe Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../debug.html">Debug Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ver.html">UVM Verification</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">Minimal NDK Application Docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../mfb.html">MFB Tools</a></li>
      <li class="breadcrumb-item active">Rate Limiter</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../_sources/ofm_doc/comp/mfb_tools/flow/rate_limiter/readme.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="rate-limiter">
<span id="id1"></span><h1>Rate Limiter<a class="headerlink" href="#rate-limiter" title="Permalink to this heading"></a></h1>
<p>The Rate limiter modifies the output speed according to the given configuration. The user is able to set the speed to anything from a constant rate to complex patterns needed for a specific application.</p>
<section id="operation">
<h2>Operation<a class="headerlink" href="#operation" title="Permalink to this heading"></a></h2>
<p>The component forwards the incoming data unchanged. Based on the values loaded to the configuration registers, it either lets the traffic flow through at full speed or slows the traffic down when the limit of the configured speed is reached. The user configures the output speed per each Interval (see the picture below). Each Interval can be configured to a different throughput speed via the corresponding register in the address space. The component loops over all configured Intervals, and after the last one, it starts again from the beginning.</p>
<p>There is a maximum amount of Intervals that can be configured, given by the INTERVAL_COUNT generic value. Each Interval consists of an INTERVAL_LENGTH number of Sections, where every Section lasts SECTION_LENGTH clock cycles. Within each Section, the incoming stream of data flows through the component at full speed until the configured speed limit is reached. Reaching the speed limit results in the flow being stopped completely which means the output speed is either full throughput or none. The configured speed only determines the proportion between these two states. At the end of the Section, the flow is restored (to full throughput) and the process is repeated in the next Section. The component detects that the limit is reached with a delay of three clock cycles, so the real amount of transmitted data could be a little over the limit. The SECTION_LENGTH value should be set to be sufficiently big to minimalize the consequence of the three-clock cycle delay.</p>
<figure class="align-center" id="timespace">
<a class="reference internal image-reference" href="../../../../../_images/timespace.svg"><img alt="../../../../../_images/timespace.svg" src="../../../../../_images/timespace.svg" width="100%" /></a>
</figure>
<ul class="simple">
<li><p>INTERVAL_COUNT  = 8 intervals</p></li>
<li><p>INTERVAL_LENGTH = 16 sections</p></li>
<li><p>SECTION_LENGTH  = default 1000 ticks</p></li>
<li><p>The arrows illustrate the moments when the flow of data is restored.</p></li>
<li><p>The speeds are switched in the following order: 10Gb/s, 50Gb/s, 0Gb/s, 75Gb/s, 60Gb/s, 10Gb/s, … and so on.</p></li>
</ul>
<p>The component is set to transfer data at a constant speed of 100 Gb/s by default (&#64;200MHz). If the speed value is given to the component directly via the generic OUTPUT_SPEED or otherwise, it has to be recalculated to bytes per section. Then the flow can be easily stopped when the number of transmitted bytes reaches this value.</p>
<dl class="vhdl autoentity">
<dt class="sig sig-object vhdl" id="vhdl-entity-rate_limiter">
<span class="k"><span class="pre">ENTITY</span> </span><span class="sig-name descname"><span class="pre">RATE_LIMITER</span></span><span class="k"> <span class="pre">IS</span></span><a class="headerlink" href="#vhdl-entity-rate_limiter" title="Permalink to this definition"></a></dt>
<dd><span class="sig-name descname">Generics</span><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Generic</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even" id="vhdl-gengeneric-rate_limiter-mi_data_width"><td><p>MI_DATA_WIDTH</p></td>
<td><p>natural</p></td>
<td><p>32</p></td>
<td><p>MI Data word width (in bits)</p></td>
</tr>
<tr class="row-odd" id="vhdl-gengeneric-rate_limiter-mi_addr_width"><td><p>MI_ADDR_WIDTH</p></td>
<td><p>natural</p></td>
<td><p>32</p></td>
<td><p>MI Address word width (in bits)</p></td>
</tr>
<tr class="row-even" id="vhdl-gengeneric-rate_limiter-mfb_regions"><td><p>MFB_REGIONS</p></td>
<td><p>natural</p></td>
<td><p>1</p></td>
<td><p>Number of MFB regions (rx and tx)</p></td>
</tr>
<tr class="row-odd" id="vhdl-gengeneric-rate_limiter-mfb_region_size"><td><p>MFB_REGION_SIZE</p></td>
<td><p>natural</p></td>
<td><p>8</p></td>
<td><p>MFB region size (in number of blocks)</p></td>
</tr>
<tr class="row-even" id="vhdl-gengeneric-rate_limiter-mfb_block_size"><td><p>MFB_BLOCK_SIZE</p></td>
<td><p>natural</p></td>
<td><p>8</p></td>
<td><p>MFB block size (in number of items)</p></td>
</tr>
<tr class="row-odd" id="vhdl-gengeneric-rate_limiter-mfb_item_width"><td><p>MFB_ITEM_WIDTH</p></td>
<td><p>natural</p></td>
<td><p>8</p></td>
<td><p>MFB item width (in bits)</p></td>
</tr>
<tr class="row-even" id="vhdl-gengeneric-rate_limiter-mfb_meta_width"><td><p>MFB_META_WIDTH</p></td>
<td><p>natural</p></td>
<td><p>0</p></td>
<td><p>MFB metadata width (in bits)</p></td>
</tr>
<tr class="row-odd" id="vhdl-gengeneric-rate_limiter-section_length"><td><p>SECTION_LENGTH</p></td>
<td><p>natural</p></td>
<td><p>1000</p></td>
<td><p>Default section length (in number of clock cycles)</p></td>
</tr>
<tr class="row-even" id="vhdl-gengeneric-rate_limiter-interval_length"><td><p>INTERVAL_LENGTH</p></td>
<td><p>natural</p></td>
<td><p>40</p></td>
<td><p>Default interval length (in number of sections)</p></td>
</tr>
<tr class="row-odd" id="vhdl-gengeneric-rate_limiter-interval_count"><td><p>INTERVAL_COUNT</p></td>
<td><p>natural</p></td>
<td><p>32</p></td>
<td><p>Maximum number of intervals (different speed registers)</p></td>
</tr>
<tr class="row-even" id="vhdl-gengeneric-rate_limiter-output_speed"><td><p>OUTPUT_SPEED</p></td>
<td><p>natural</p></td>
<td><p>62500</p></td>
<td><p>Default output speed (in bytes per section)</p></td>
</tr>
<tr class="row-odd" id="vhdl-gengeneric-rate_limiter-frequency"><td><p>FREQUENCY</p></td>
<td><p>natural</p></td>
<td><p>200</p></td>
<td><p>Operating frequency in MHz (used in SW for calculation of output speed)</p></td>
</tr>
<tr class="row-even" id="vhdl-gengeneric-rate_limiter-device"><td><p>DEVICE</p></td>
<td><p>string</p></td>
<td><p>“AGILEX”</p></td>
<td><p>Target device</p></td>
</tr>
</tbody>
</table>
<span class="sig-name descname">Ports</span><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Port</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Mode</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even" id="vhdl-portsignal-rate_limiter-clk"><td><p>CLK</p></td>
<td><p>std_logic</p></td>
<td><p>in</p></td>
<td><p>Clock and Reset</p></td>
</tr>
<tr class="row-odd" id="vhdl-portsignal-rate_limiter-reset"><td><p>RESET</p></td>
<td><p>std_logic</p></td>
<td><p>in</p></td>
<td></td>
</tr>
<tr class="row-even" id="vhdl-portsignal-rate_limiter-mi_dwr"><td><p>MI_DWR</p></td>
<td><p>std_logic_vector(MI_DATA_WIDTH-1 downto 0)</p></td>
<td><p>in</p></td>
<td><p>MI configuration interface</p></td>
</tr>
<tr class="row-odd" id="vhdl-portsignal-rate_limiter-mi_addr"><td><p>MI_ADDR</p></td>
<td><p>std_logic_vector(MI_ADDR_WIDTH-1 downto 0)</p></td>
<td><p>in</p></td>
<td></td>
</tr>
<tr class="row-even" id="vhdl-portsignal-rate_limiter-mi_rd"><td><p>MI_RD</p></td>
<td><p>std_logic</p></td>
<td><p>in</p></td>
<td></td>
</tr>
<tr class="row-odd" id="vhdl-portsignal-rate_limiter-mi_wr"><td><p>MI_WR</p></td>
<td><p>std_logic</p></td>
<td><p>in</p></td>
<td></td>
</tr>
<tr class="row-even" id="vhdl-portsignal-rate_limiter-mi_be"><td><p>MI_BE</p></td>
<td><p>std_logic_vector((MI_DATA_WIDTH/8)-1 downto 0)</p></td>
<td><p>in</p></td>
<td></td>
</tr>
<tr class="row-odd" id="vhdl-portsignal-rate_limiter-mi_drd"><td><p>MI_DRD</p></td>
<td><p>std_logic_vector(MI_DATA_WIDTH-1 downto 0)</p></td>
<td><p>out</p></td>
<td></td>
</tr>
<tr class="row-even" id="vhdl-portsignal-rate_limiter-mi_ardy"><td><p>MI_ARDY</p></td>
<td><p>std_logic</p></td>
<td><p>out</p></td>
<td></td>
</tr>
<tr class="row-odd" id="vhdl-portsignal-rate_limiter-mi_drdy"><td><p>MI_DRDY</p></td>
<td><p>std_logic</p></td>
<td><p>out</p></td>
<td></td>
</tr>
<tr class="row-even" id="vhdl-portsignal-rate_limiter-rx_mfb_data"><td><p>RX_MFB_DATA</p></td>
<td><p>std_logic_vector(MFB_REGIONS*MFB_REGION_SIZE*MFB_BLOCK_SIZE*MFB_ITEM_WIDTH-1 downto 0)</p></td>
<td><p>in</p></td>
<td><p>MFB input interface</p></td>
</tr>
<tr class="row-odd" id="vhdl-portsignal-rate_limiter-rx_mfb_meta"><td><p>RX_MFB_META</p></td>
<td><p>std_logic_vector(MFB_REGIONS*MFB_META_WIDTH-1 downto 0)</p></td>
<td><p>in</p></td>
<td></td>
</tr>
<tr class="row-even" id="vhdl-portsignal-rate_limiter-rx_mfb_sof"><td><p>RX_MFB_SOF</p></td>
<td><p>std_logic_vector(MFB_REGIONS-1 downto 0)</p></td>
<td><p>in</p></td>
<td></td>
</tr>
<tr class="row-odd" id="vhdl-portsignal-rate_limiter-rx_mfb_eof"><td><p>RX_MFB_EOF</p></td>
<td><p>std_logic_vector(MFB_REGIONS-1 downto 0)</p></td>
<td><p>in</p></td>
<td></td>
</tr>
<tr class="row-even" id="vhdl-portsignal-rate_limiter-rx_mfb_sof_pos"><td><p>RX_MFB_SOF_POS</p></td>
<td><p>std_logic_vector(MFB_REGIONS*max(1, log2(MFB_REGION_SIZE))-1 downto 0)</p></td>
<td><p>in</p></td>
<td></td>
</tr>
<tr class="row-odd" id="vhdl-portsignal-rate_limiter-rx_mfb_eof_pos"><td><p>RX_MFB_EOF_POS</p></td>
<td><p>std_logic_vector(MFB_REGIONS*max(1, log2(MFB_REGION_SIZE*MFB_BLOCK_SIZE))-1 downto 0)</p></td>
<td><p>in</p></td>
<td></td>
</tr>
<tr class="row-even" id="vhdl-portsignal-rate_limiter-rx_mfb_src_rdy"><td><p>RX_MFB_SRC_RDY</p></td>
<td><p>std_logic</p></td>
<td><p>in</p></td>
<td></td>
</tr>
<tr class="row-odd" id="vhdl-portsignal-rate_limiter-rx_mfb_dst_rdy"><td><p>RX_MFB_DST_RDY</p></td>
<td><p>std_logic</p></td>
<td><p>out</p></td>
<td></td>
</tr>
<tr class="row-even" id="vhdl-portsignal-rate_limiter-tx_mfb_data"><td><p>TX_MFB_DATA</p></td>
<td><p>std_logic_vector(MFB_REGIONS*MFB_REGION_SIZE*MFB_BLOCK_SIZE*MFB_ITEM_WIDTH-1 downto 0)</p></td>
<td><p>out</p></td>
<td><p>MFB output interface</p></td>
</tr>
<tr class="row-odd" id="vhdl-portsignal-rate_limiter-tx_mfb_meta"><td><p>TX_MFB_META</p></td>
<td><p>std_logic_vector(MFB_REGIONS*MFB_META_WIDTH-1 downto 0)</p></td>
<td><p>out</p></td>
<td></td>
</tr>
<tr class="row-even" id="vhdl-portsignal-rate_limiter-tx_mfb_sof"><td><p>TX_MFB_SOF</p></td>
<td><p>std_logic_vector(MFB_REGIONS-1 downto 0)</p></td>
<td><p>out</p></td>
<td></td>
</tr>
<tr class="row-odd" id="vhdl-portsignal-rate_limiter-tx_mfb_eof"><td><p>TX_MFB_EOF</p></td>
<td><p>std_logic_vector(MFB_REGIONS-1 downto 0)</p></td>
<td><p>out</p></td>
<td></td>
</tr>
<tr class="row-even" id="vhdl-portsignal-rate_limiter-tx_mfb_sof_pos"><td><p>TX_MFB_SOF_POS</p></td>
<td><p>std_logic_vector(MFB_REGIONS*max(1, log2(MFB_REGION_SIZE))-1 downto 0)</p></td>
<td><p>out</p></td>
<td></td>
</tr>
<tr class="row-odd" id="vhdl-portsignal-rate_limiter-tx_mfb_eof_pos"><td><p>TX_MFB_EOF_POS</p></td>
<td><p>std_logic_vector(MFB_REGIONS*max(1, log2(MFB_REGION_SIZE*MFB_BLOCK_SIZE))-1 downto 0)</p></td>
<td><p>out</p></td>
<td></td>
</tr>
<tr class="row-even" id="vhdl-portsignal-rate_limiter-tx_mfb_src_rdy"><td><p>TX_MFB_SRC_RDY</p></td>
<td><p>std_logic</p></td>
<td><p>out</p></td>
<td></td>
</tr>
<tr class="row-odd" id="vhdl-portsignal-rate_limiter-tx_mfb_dst_rdy"><td><p>TX_MFB_DST_RDY</p></td>
<td><p>std_logic</p></td>
<td><p>in</p></td>
<td></td>
</tr>
</tbody>
</table>
</dd></dl>

</section>
<section id="address-space-and-configuration">
<h2>Address space and configuration<a class="headerlink" href="#address-space-and-configuration" title="Permalink to this heading"></a></h2>
<p>The component has several registers accessible through the MI interface that are used for its configuration.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Address offset</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0x00</p></td>
<td><p>status register</p></td>
</tr>
<tr class="row-odd"><td><p>0x04</p></td>
<td><p>section length register</p></td>
</tr>
<tr class="row-even"><td><p>0x08</p></td>
<td><p>interval length register</p></td>
</tr>
<tr class="row-odd"><td><p>0x0c</p></td>
<td><p>interval count register (read-only)</p></td>
</tr>
<tr class="row-even"><td><p>0x10</p></td>
<td><p>frequency (read-only)</p></td>
</tr>
<tr class="row-odd"><td><p>0x14</p></td>
<td><p>1st speed register</p></td>
</tr>
<tr class="row-even"><td><p>0x18</p></td>
<td><p>2nd speed register (INTERVAL_COUNT &gt; 1)</p></td>
</tr>
<tr class="row-odd"><td><p>…</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>0x??</p></td>
<td><p>last speed register -&gt; 0x14 + (INTERVAL_COUNT-1)*4</p></td>
</tr>
</tbody>
</table>
<p>The data registers correspond with the information given in paragraph ‘Generic parameters’ and the status register fields are described below.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>SR Flag (bit)</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>idle flag (1 = idle, 0 = busy)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>configuration (W: 1 = start, 0 = stop) / is in configuration state (R)</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>traffic shaping (W: 1 = start, 0 = stop) / traffic shaping is running (R)</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>reset pointer to the first configured speed</p></td>
</tr>
</tbody>
</table>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this heading"></a></h2>
<p>The status register is mainly used as a control register. To configure the component first set ‘configuration’ bit to 1. When in configuration state user can configure all of the data registers (except ‘interval count’ and ‘frequency’ registers which are read-only). To start the traffic shaping set ‘traffic shaping’ bit to 1 (when starting from configuration state also set ‘configuration’ bit to 0). Setting both flags to 1 at the same time will result in switching to configuration state due to the implemented priority. By default when switched from traffic shaping state to idle state, the pointer to the active speed is not reset. So when switched back to traffic shaping, it will continue from the last speed where the run was interrupted. If this behavior is unwanted, the pointer has to be reset manually by setting the last field in the table above to 1 (in idle state).</p>
</section>
<section id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>To simulate intervals of different lengths, set the same output speed to more intervals in a row.</p></li>
<li><p>Remember to set consecutive speed registers. Upon encountering a gap in the form of an invalid (not set) speed register the component loops from the first speed again.</p></li>
<li><p>When reading a speed register the most significant bit indicates whether the value was configured during the last configuration and is therefore valid (1) or not valid (0).</p></li>
<li><p>The preferred way of interacting with the component is by using the provided software.</p></li>
<li><p>The component starts in the RUN state with traffic flowing through.</p></li>
<li><p>When switched to configuration state speed registers get reset.</p></li>
<li><p>The component supports the BE signal internally, although its usage is not needed anywhere in the current version.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../enabler/readme.html" class="btn btn-neutral float-left" title="MFB Enabler" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../packet_delayer/readme.html" class="btn btn-neutral float-right" title="Packet Delayer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, CESNET z.s.p.o..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>