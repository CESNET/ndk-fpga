

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SystemVerilog and UVM tutorial &mdash; NDK-FPGA Docs  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme_overrides.css?v=b530091d" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="UVM simulation" href="sim_manual.html" />
    <link rel="prev" title="UVM Verification" href="../../ver.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            NDK-FPGA Docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Application:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../app-minimal.html">Minimal NDK application</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Network Development Kit:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ndk_core/doc/how_to_start.html">How to start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ndk_core/doc/terminology.html">NDK Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ndk_core/doc/readme.html">NDK Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ndk_core/doc/configuration.html">Configuration files and parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ndk_core/doc/testing.html">NDK testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ndk_build/readme.html">Build System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ndk_core/doc/devtree.html">Device Tree</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ndk_core/doc/faq.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Supported cards:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ndk_cards/reflexces/agi-fh400g/readme.html">ReflexCES XpressSX AGI-FH400G</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ndk_cards/intel/dk-dev-1sdx-p/readme.html">Intel Stratix 10 DX FPGA DK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ndk_cards/intel/dk-dev-agi027res/readme.html">Intel Agilex I-Series FPGA DK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ndk_cards/silicom/fb4cgg3/readme.html">Silicom fb4CGg3&#64;VU9P</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ndk_cards/silicom/fb2cghh/readme.html">Silicom fb2CGhh&#64;KU15P</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ndk_cards/silicom/n6010/readme.html">Silicom N6010</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ndk_cards/bittware/ia-420f/readme.html">Bittware IA-420F</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ndk_cards/amd/alveo-u200/readme.html">AMD Alveo U200</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ndk_cards/amd/alveo-u55c/readme.html">AMD Alveo U55C</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ndk_cards/amd/vcu118/readme.html">AMD VCU118&#64;VU9P</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ndk_cards/prodesign/pd-falcon/readme.html">PRO DESIGN Falcon</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">VHDL components:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../base.html">Basic Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ctrls.html">Controllers &amp; TSU</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mi.html">MI Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mfb.html">MFB Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mvb.html">MVB Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nic.html">Network Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pcie.html">PCIe Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../debug.html">Debug Tools</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../ver.html">UVM Verification</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">SystemVerilog and UVM tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#other-tutorials">Other tutorials</a></li>
<li class="toctree-l3"><a class="reference internal" href="#basic-usage-of-the-uvm-methodology-in-the-ofm-repository">Basic usage of the UVM methodology in the OFM repository</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#interface">Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="#properties">Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#driver">Driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="#agent">Agent</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-object">Configuration object</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sequence">Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sequence-library">Sequence library</a></li>
<li class="toctree-l4"><a class="reference internal" href="#package">Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="#layered-agents">Layered agents</a></li>
<li class="toctree-l4"><a class="reference internal" href="#environment">Environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#low-level-sequence">Low-level sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="#high-level-monitor">High-level monitor</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">Configuration object</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Sequence library</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run-of-a-specific-sequence">Run of a specific sequence</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#common-environment">Common environment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#virtual-sequencer">Virtual sequencer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#virtual-sequence-and-synchronization">Virtual sequence and synchronization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#scoreboard">Scoreboard</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#request-response-agents">Request-response Agents</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reset">Reset</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Scoreboard</a></li>
<li class="toctree-l3"><a class="reference internal" href="#coverage">Coverage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#functional-coverage">Functional coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#code-coverage">Code coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generating-coverage-reports">Generating coverage reports</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#verification-example">Verification example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#byte-array-port-environment">Byte_array_port environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#model">Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-model-input-fifo">Create model input fifo</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">Scoreboard</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test-environment">Test environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test">Test</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#testbench">Testbench</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#notes">NOTES</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#uvm-info">UVM_info</a></li>
<li class="toctree-l4"><a class="reference internal" href="#uvm-error-vs-uvm-fatal">UVM_error vs UVM_fatal</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parametrized-object">Parametrized object</a></li>
<li class="toctree-l4"><a class="reference internal" href="#synchronization">Synchronization</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ofm-verification-environment">OFM verification environment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modules-tcl">Modules.tcl</a></li>
<li class="toctree-l4"><a class="reference internal" href="#main-fdo-script-for-running-the-verification">Main .fdo script for running the verification</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sim_manual.html">UVM simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="componets.html">Components</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">NDK-FPGA Docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../ver.html">UVM Verification</a></li>
      <li class="breadcrumb-item active">SystemVerilog and UVM tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/comp/uvm/manual.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="systemverilog-and-uvm-tutorial">
<span id="uvm-manual"></span><h1>SystemVerilog and UVM tutorial<a class="headerlink" href="#systemverilog-and-uvm-tutorial" title="Link to this heading"></a></h1>
<p>This is manual describes how the UVM verification in our environment should be
written.</p>
<section id="other-tutorials">
<h2>Other tutorials<a class="headerlink" href="#other-tutorials" title="Link to this heading"></a></h2>
<p>This document does not serve as a general UVM or a SystemVerilog manual. Various
tutorials can be found at:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.asic-world.com/systemverilog/tutorial.html">SystemVerilog tutorial</a></p></li>
<li><p><a class="reference external" href="https://verificationguide.com/uvm/uvm-tutorial/">UVM tutorial</a></p></li>
<li><p><a class="reference external" href="https://www.accellera.org/images/downloads/standards/uvm/uvm_users_guide_1.2.pdf">UVM user guide</a></p></li>
<li><p><a class="reference external" href="https://www.doulos.com/media/1277/easier-uvm-coding-guidelines-2016-06-24.pdf">Doulos coding guidelines</a></p></li>
<li><p><a class="reference external" href="https://www.amiq.com/consulting/2017/05/29/how-to-pack-data-using-systemverilog-streaming-operators/">Packing</a></p></li>
<li><p><a class="reference external" href="https://www.amiq.com/consulting/2017/06/23/how-to-unpack-data-using-the-systemverilog-streaming-operators/">Unpacking</a></p></li>
<li><p><a class="reference external" href="http://www.asic-world.com/systemverilog/assertions.html">SystemVerilog Assertion (asic-world)</a></p></li>
<li><p><a class="reference external" href="https://www.einfochips.com/blog/system-verilog-assertions-simplified/">SystemVerilog Assertion (einfochips)</a></p></li>
</ul>
</section>
<section id="basic-usage-of-the-uvm-methodology-in-the-ofm-repository">
<h2>Basic usage of the UVM methodology in the OFM repository<a class="headerlink" href="#basic-usage-of-the-uvm-methodology-in-the-ofm-repository" title="Link to this heading"></a></h2>
<p>This document describes one of the possible solutions for some common verification issues.</p>
<section id="interface">
<h3>Interface<a class="headerlink" href="#interface" title="Link to this heading"></a></h3>
<p>An Interface creates connections between the Device Under Test(DUT) and the
verification environment. If there is no serious reason to do otherwise, use
<em>wire logic</em> instead of <em>logic</em>. <em>Wire logic</em> is a net whereas <em>logic</em>
is a variable. The reason for this solution is that we want to use a common
interface for both, RX and TX communication(if you want to learn more, visit
<a class="reference external" href="https://blogs.sw.siemens.com/verificationhorizons/2013/05/03/wire-vs-reg/">Wire logic vs logic</a>).
It is required to use a clocking block in an Interface if there is no reason to
do otherwise. Interfaces do not have namespaces therefore each one must have a
unique name.</p>
</section>
<section id="properties">
<h3>Properties<a class="headerlink" href="#properties" title="Link to this heading"></a></h3>
<p>The DUT often communicates with its surroundings using a specific protocol which
usually has some restrictions. These restrictions can be controlled by the
Properties module which can be instantiated and connected to an Interface. The
module then controls whether the DUT behaves according to the specification of
the given communication protocol.</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="k">module</span><span class="w"> </span><span class="n">mfb_properties</span><span class="w"> </span><span class="p">(</span><span class="k">input</span><span class="w"> </span><span class="kt">logic</span><span class="w"> </span><span class="n">RESET</span><span class="p">,</span><span class="w"> </span><span class="n">mfb_if</span><span class="w"> </span><span class="n">RX_MFB</span><span class="p">);</span>

<span class="w">    </span><span class="k">property</span><span class="w"> </span><span class="n">prop_rdy</span><span class="p">;</span>
<span class="w">        </span><span class="p">(</span><span class="k">posedge</span><span class="w"> </span><span class="n">RX_MFB</span><span class="p">.</span><span class="n">CLK</span><span class="p">)</span><span class="w"> </span><span class="k">disable</span><span class="w"> </span><span class="k">iff</span><span class="p">(</span><span class="n">RESET</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mb">1&#39;b1</span><span class="p">)</span>
<span class="w">        </span><span class="o">!</span><span class="p">$</span><span class="n">isunknown</span><span class="p">(</span><span class="n">MFB_IF</span><span class="p">.</span><span class="n">DST_RDY</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="p">$</span><span class="n">isunknown</span><span class="p">(</span><span class="n">MFB_IF</span><span class="p">.</span><span class="n">SRC_RDY</span><span class="p">);</span>
<span class="w">    </span><span class="k">endproperty</span>

<span class="w">    </span><span class="k">assert</span><span class="w"> </span><span class="k">property</span><span class="w"> </span><span class="p">(</span><span class="n">prop_rdy</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span><span class="no">`uvm_fatal</span><span class="p">(</span><span class="s">&quot;MFB INTERFACE: src and dst rdy have to be always valid</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">end</span>

<span class="k">endmodule</span>
</pre></div>
</div>
</section>
<section id="driver">
<h3>Driver<a class="headerlink" href="#driver" title="Link to this heading"></a></h3>
<p>A Driver writes data to an Interface. It is required to use the <strong>try_get</strong> or
<strong>try_next_item</strong> function to get the next item. Using the <strong>get</strong> or
<strong>get_next_item</strong> function is not recommended. For example, if a Sequence uses
wait <em>#(4ns)</em>, it can desynchronize the Driver when a Clocking Block is in use
and a race condition can occur.</p>
<p>Example of the sequence with 10ns space between items:</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">sequence_simple</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_sequence</span><span class="p">#(</span><span class="n">sequence_item</span><span class="p">);</span>
<span class="w">    </span><span class="no">`uvm_object_utils</span><span class="p">(</span><span class="n">pkg</span><span class="o">::</span><span class="n">sequence_simple</span><span class="p">)</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">task</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="p">();</span>

<span class="w">        </span><span class="n">req</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sequence_item</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;req&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="n">it</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="n">start_item</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
<span class="w">            </span><span class="n">req</span><span class="p">.</span><span class="n">randomize</span><span class="p">();</span>
<span class="w">            </span><span class="n">finish_item</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
<span class="w">            </span><span class="p">#(</span><span class="mi">10</span><span class="p">)</span><span class="n">ns</span><span class="w"> </span><span class="c1">// using the *get* task instead of *try_get* in a driver can put it out of synchronization or break a protocol</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">    </span><span class="k">endtask</span>
<span class="kd">endclass</span>
</pre></div>
</div>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">driver</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_driver</span><span class="p">#(</span><span class="n">sequence_item</span><span class="p">);</span>
<span class="w">    </span><span class="no">`uvm_component_utils</span><span class="p">(</span><span class="n">pkg</span><span class="o">::</span><span class="n">driver</span><span class="p">)</span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="k">interface</span><span class="w"> </span><span class="n">vif</span><span class="p">;</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">uvm_component</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">);</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">task</span><span class="w"> </span><span class="n">run_phase</span><span class="w"> </span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>

<span class="w">        </span><span class="k">forever</span><span class="w"> </span><span class="k">begin</span>

<span class="w">            </span><span class="n">seq_item_port</span><span class="p">.</span><span class="n">try_next_item</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">req</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">                </span><span class="n">vif</span><span class="p">.</span><span class="n">cb</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">req</span><span class="p">.</span><span class="n">data</span><span class="p">;</span>
<span class="w">                </span><span class="n">seq_item_port</span><span class="p">.</span><span class="n">item_done</span><span class="p">();</span>
<span class="w">            </span><span class="k">end</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">begin</span>
<span class="w">                </span><span class="n">vif</span><span class="p">.</span><span class="n">cb</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">&#39;x</span><span class="p">;</span>
<span class="w">            </span><span class="k">end</span>

<span class="w">            </span><span class="p">@(</span><span class="n">vif</span><span class="p">.</span><span class="n">cb</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">    </span><span class="k">endtask</span>
<span class="kd">endclass</span>
</pre></div>
</div>
</section>
<section id="agent">
<h3>Agent<a class="headerlink" href="#agent" title="Link to this heading"></a></h3>
<p>Please stick to the following rules when writing agents, environments or
packages:</p>
<ol class="arabic simple">
<li><p>Use the name of the class together with the name of the package in the UVM registration macros.</p></li>
<li><p>The name of a class should be <em>monitor, driver, sequencer, config,
sequence_item</em>. A suffix such as *_rx, *_tx can be used if required.</p></li>
<li><p>For sequences, use the sequence_* prefix.</p></li>
<li><p>Variable names should have the prefix m_*.</p></li>
<li><p>A file should have the same name as the class it contains. Each agent is placed into its
own directory together with a package file <em>pkg.sv</em> and interface file
<em>interface.sv</em> if the interface is required.</p></li>
</ol>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">agent</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_agent</span><span class="p">;</span>
<span class="w">    </span><span class="no">`uvm_component_utils</span><span class="p">(</span><span class="w"> </span><span class="n">example</span><span class="o">::</span><span class="n">agent</span><span class="w"> </span><span class="p">)</span>

<span class="w">    </span><span class="n">uvm_analysis_port</span><span class="p">#(</span><span class="n">sequence_item</span><span class="p">)</span><span class="w">   </span><span class="n">analysis_port</span><span class="p">;</span>
<span class="w">    </span><span class="k">config</span><span class="w">                              </span><span class="n">m_config</span><span class="p">;</span>
<span class="w">    </span><span class="n">sequencer</span><span class="w">                           </span><span class="n">m_sequencer</span><span class="p">;</span>
<span class="w">    </span><span class="n">driver</span><span class="w">                              </span><span class="n">m_driver</span><span class="p">;</span>
<span class="w">    </span><span class="n">monitor</span><span class="w">                             </span><span class="n">m_monitor</span><span class="p">;</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">uvm_component</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">);</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">build_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>

<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="n">build_phase</span><span class="p">(</span><span class="n">phase</span><span class="p">);</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">uvm_config_db</span><span class="p">#(</span><span class="k">config</span><span class="p">)</span><span class="o">::</span><span class="n">get</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;m_config&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_config</span><span class="p">))</span>
<span class="w">            </span><span class="no">`uvm_fatal</span><span class="p">(...);</span>

<span class="w">        </span><span class="c1">// The value of the first parameter has to be the same as the name of the variable</span>
<span class="w">        </span><span class="n">m_monitor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">monitor</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;m_monitor&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_config</span><span class="p">.</span><span class="n">active</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ACTIVE</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="n">m_driver</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">driver</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;m_driver&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">            </span><span class="n">m_sequencer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sequencer</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;m_sequencer&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">connect_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>

<span class="w">        </span><span class="k">virtual</span><span class="w"> </span><span class="n">axi_lite_interface</span><span class="w"> </span><span class="p">#(</span><span class="n">ADDR_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">DATA_WIDTH</span><span class="p">)</span><span class="w"> </span><span class="n">vif</span><span class="p">;</span>

<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="n">connect_phase</span><span class="p">(</span><span class="n">phase</span><span class="p">);</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">uvm_config_db</span><span class="p">#(</span><span class="k">virtual</span><span class="w"> </span><span class="n">axi_lite_interface</span><span class="p">#(</span><span class="n">ADDR_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">DATA_WIDTH</span><span class="p">))</span><span class="o">::</span><span class="n">get</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;interface&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">vif</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="no">`uvm_fatal</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">get_full_name</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;Virtual interface axi_lite_interface has not been found.&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">        </span><span class="n">m_monitor</span><span class="p">.</span><span class="n">vif</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">vif</span><span class="p">;</span>
<span class="w">        </span><span class="n">analysis_port</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">m_monitor</span><span class="p">.</span><span class="n">analysis_port</span><span class="p">;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_config</span><span class="p">.</span><span class="n">active</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ACTIVE</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="n">m_driver</span><span class="p">.</span><span class="n">vif</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vif</span><span class="p">;</span>
<span class="w">            </span><span class="n">m_driver</span><span class="p">.</span><span class="n">seq_item_port</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">m_sequencer</span><span class="p">.</span><span class="n">seq_item_export</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">    </span><span class="k">endfunction</span>
<span class="kd">endclass</span>
</pre></div>
</div>
</section>
<section id="configuration-object">
<h3>Configuration object<a class="headerlink" href="#configuration-object" title="Link to this heading"></a></h3>
<p>Every agent has its own configuration object, which can modify its behavior.
There are two most commonly used variables in the configuration object. The
first one is the <em>active</em> variable which indicates whether the agent is active
or passive. An active agent contains a driver and actively drives communication
through the interface. A passive agent is used for observation of the
communication on the interface. The second one is the <em>interface_name</em> variable
which is used in the case of direct communication between the agent and the DUT.
The agent finds the correct interface in the UVM configuration database under
the <em>interface_name</em>.</p>
</section>
<section id="sequence">
<h3>Sequence<a class="headerlink" href="#sequence" title="Link to this heading"></a></h3>
<p>The sequence contains three functions that can change the randomization output
(<em>pre_do</em>, <em>mid_do</em>, <em>post_do</em>). Function <em>pre_do</em> is called before the
randomization. It is suitable for changing the randomization rules. Function
<em>mid_do</em> is called after the randomization and before the result is sent to the
driver. This is suitable for setting a specific value that would be difficult to
randomize. Function <em>post_do</em> is called after the driver processes a
transaction. This is suitable for generating statistics or do some post
processing.</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">config_sequence</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">config</span><span class="o">::</span><span class="n">simple_simple</span><span class="p">;</span>
<span class="w">    </span><span class="no">`uvm_object_utils</span><span class="p">(</span><span class="n">seq</span><span class="o">::</span><span class="n">config_sequence</span><span class="p">)</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">pre_do</span><span class="p">(</span><span class="n">uvm_sequence_item</span><span class="w"> </span><span class="n">this_item</span><span class="p">);</span>
<span class="w">        </span><span class="c1">//this happens before the randomization</span>
<span class="w">        </span><span class="n">this_item</span><span class="p">.</span><span class="n">size_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">mid_do</span><span class="p">(</span><span class="n">uvm_sequence_item</span><span class="w"> </span><span class="n">this_item</span><span class="p">);</span>
<span class="w">        </span><span class="c1">//this happens after the randomization</span>
<span class="w">        </span><span class="n">this_item</span><span class="p">.</span><span class="n">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addr</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">post_do</span><span class="p">(</span><span class="n">uvm_sequence_item</span><span class="w"> </span><span class="n">this_item</span><span class="p">);</span>
<span class="w">        </span><span class="c1">//this happens after a sequence item has been processed</span>
<span class="w">        </span><span class="n">cfg</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">this_item</span><span class="p">.</span><span class="n">data</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>
<span class="kd">endclass</span>
</pre></div>
</div>
</section>
<section id="sequence-library">
<h3>Sequence library<a class="headerlink" href="#sequence-library" title="Link to this heading"></a></h3>
<p>For all agents, it is recommended to create a Sequence library that contains
multiple sequences. More sequences help to uncover more bugs and it also
improves coverage with small effort. The Sequence library randomly selects a
sequence and runs it on the current Sequencer. This is repeated until the
Sequence library runs the required number of sequences. Each sequence can create
a different test scenario like burst mode, transmission of small or large
packets, sequential read/write operations on the same address and more.</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">sequence_packet_small</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_sequence</span><span class="w"> </span><span class="p">#(</span><span class="n">sequence_item</span><span class="p">);</span>
<span class="w">    </span><span class="no">`uvm_object_utils</span><span class="p">(</span><span class="n">example</span><span class="o">::</span><span class="n">sequence_packet_small</span><span class="p">)</span>

<span class="w">     </span><span class="k">rand</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">transactions</span><span class="p">;</span>

<span class="w">    </span><span class="n">constraints</span><span class="w"> </span><span class="n">c_transactions</span><span class="p">{</span>
<span class="w">        </span><span class="n">transactions</span><span class="w"> </span><span class="ow">inside</span><span class="w"> </span><span class="p">{[</span><span class="mi">100</span><span class="o">:</span><span class="mi">2000</span><span class="p">]};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">task</span><span class="w"> </span><span class="n">body</span><span class="p">();</span>

<span class="w">        </span><span class="n">req</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sequence_item</span><span class="p">#(</span><span class="n">C_CHAR_WIDTH</span><span class="p">)</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;req&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">transactions</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="n">start_item</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
<span class="w">            </span><span class="n">req</span><span class="p">.</span><span class="n">randomize</span><span class="p">()</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="p">{</span><span class="n">data</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="ow">inside</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">10</span><span class="p">]};</span>
<span class="w">            </span><span class="n">finish_item</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">    </span><span class="k">endtask</span>

<span class="kd">endclass</span>
</pre></div>
</div>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">sequence_packet_large</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_sequence</span><span class="w"> </span><span class="p">#(</span><span class="n">sequence_item</span><span class="p">);</span>
<span class="w">    </span><span class="no">`uvm_object_utils</span><span class="p">(</span><span class="n">example</span><span class="o">::</span><span class="n">sequence_packet_large</span><span class="p">)</span>

<span class="w">    </span><span class="k">rand</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">transactions</span><span class="p">;</span>

<span class="w">    </span><span class="n">constraints</span><span class="w"> </span><span class="n">c_transactions</span><span class="p">{</span>
<span class="w">        </span><span class="n">transactions</span><span class="w"> </span><span class="ow">inside</span><span class="w"> </span><span class="p">{[</span><span class="mi">100</span><span class="o">:</span><span class="mi">2000</span><span class="p">]};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">task</span><span class="w"> </span><span class="n">body</span><span class="p">();</span>

<span class="w">        </span><span class="n">req</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sequence_item</span><span class="p">#(</span><span class="n">C_CHAR_WIDTH</span><span class="p">)</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;req&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">transactions</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="n">start_item</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
<span class="w">            </span><span class="n">req</span><span class="p">.</span><span class="n">randomize</span><span class="p">()</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="p">{</span><span class="n">data</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="ow">inside</span><span class="w"> </span><span class="p">[</span><span class="mi">10000</span><span class="o">:</span><span class="mi">200000</span><span class="p">]};</span>
<span class="w">            </span><span class="n">finish_item</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">    </span><span class="k">endtask</span>

<span class="kd">endclass</span>
</pre></div>
</div>
<p>A creation of the sequence library:</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">sequence_lib</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_common</span><span class="o">::</span><span class="n">sequence_library</span><span class="w"> </span><span class="p">#(</span><span class="n">config_sequence</span><span class="p">,</span><span class="w"> </span><span class="n">sequence_item</span><span class="p">);</span>
<span class="w">    </span><span class="no">`uvm_object_utils</span><span class="p">(</span><span class="n">example</span><span class="o">::</span><span class="n">sequence_lib</span><span class="p">)</span>
<span class="w">    </span><span class="no">`uvm_sequence_library_utils</span><span class="p">(</span><span class="n">example</span><span class="o">::</span><span class="n">sequence_lib</span><span class="p">)</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="w">        </span><span class="n">init_sequence_library</span><span class="p">();</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="c1">// subclass can redefine and change run sequences</span>
<span class="w">    </span><span class="c1">// can be useful in specific tests</span>
<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">init_sequence</span><span class="p">(</span><span class="n">config_sequence</span><span class="w"> </span><span class="n">param_cfg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">param_cfg</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="n">cfg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">();</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="n">cfg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">param_cfg</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="n">add_sequence</span><span class="p">(</span><span class="n">sequence_packet_large</span><span class="o">::</span><span class="n">get_type</span><span class="p">());</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="n">add_sequence</span><span class="p">(</span><span class="n">sequence_packet_small</span><span class="o">::</span><span class="n">get_type</span><span class="p">());</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="kd">endclass</span>
</pre></div>
</div>
<p>Run the sequence in the environment or the test:</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">env</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_env</span>

<span class="w">    </span><span class="p">...</span>

<span class="w">    </span><span class="k">task</span><span class="w"> </span><span class="n">run_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>

<span class="w">        </span><span class="n">sequence_lib</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sequence_lib</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;sequence_lib&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">sequence_lib</span><span class="p">.</span><span class="n">init_sequence</span><span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">seq_cfg</span><span class="p">);</span>

<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">sequence_lib</span><span class="p">.</span><span class="n">randomize</span><span class="p">())</span>
<span class="w">            </span><span class="no">`uvm_fatal</span><span class="w"> </span><span class="p">(...);</span>

<span class="w">        </span><span class="n">sequence_lib</span><span class="p">.</span><span class="n">start</span><span class="p">(</span><span class="n">m_agent</span><span class="p">.</span><span class="n">m_sequencer</span><span class="p">);</span>

<span class="w">    </span><span class="k">endtask</span>

<span class="w">    </span><span class="p">...</span>

<span class="kd">endclass</span>
</pre></div>
</div>
</section>
<section id="package">
<h3>Package<a class="headerlink" href="#package" title="Link to this heading"></a></h3>
<p>In all registration macros (those are `uvm_components_* and `uvm_object_*), it
is required to use a class name together with a package name, for example:
<strong>`uvm_components_utils(pkg::class)</strong></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you don’t register a component with the package name, the verification can
instantiate the wrong class or behave strangely.</p>
</div>
<p>It is strongly recommended to use namespaces inside a verification code. Do not
use <strong>import pkg::*</strong> command unless it is necessary. The only situation where
you can use it is to import the uvm_package.</p>
</section>
<section id="layered-agents">
<h3>Layered agents<a class="headerlink" href="#layered-agents" title="Link to this heading"></a></h3>
<p>Most of the verification tests do not need to generate low-level data (i.e.
individual signals). That is why there are high-level generators that can create
whole packets. This allows for a packet approach and separates it from a
low-level protocol. For a layered agent, it is a good idea to use a pointer from
a low-level sequence to a higher sequencer. For this you need to know about the
design pattern called the <em>abstract factory</em> as well as how it is used in the
UVM methodology.</p>
</section>
<section id="environment">
<h3>Environment<a class="headerlink" href="#environment" title="Link to this heading"></a></h3>
<p>The environment groups together other environments and agents in logical order.
In this case, the environment groups high- and low-level agents. Required steps
are:</p>
<ol class="arabic simple">
<li><p>Registration of a new high-level monitor which completes a high-level
transactions from low-level transactions.</p></li>
<li><p>Creation of a low-level sequence that pulls items from the high-level
sequencer and generates low-level transactions</p></li>
<li><p>Use the second argument in function <cite>create()</cite> when creating sequence or
sequence_library because it simplifies the run of some sequences for specific
tests.</p></li>
</ol>
<img alt="layered agents" class="align-center" src="../../_images/layered_agents.svg" />
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">env</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_env</span><span class="p">;</span>

<span class="w">    </span><span class="p">...</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">build_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>

<span class="w">        </span><span class="c1">//change common monitor to specific monitor</span>
<span class="w">        </span><span class="n">byte_array_moinitor</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">set_inst_override</span><span class="p">(</span><span class="n">byte_array_mfb_monitor</span><span class="o">::</span><span class="n">get_type</span><span class="p">(),</span><span class="w"> </span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="n">get_full_name</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;.m_byte_array_agent.*&quot;</span><span class="p">});</span>

<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="n">build_phase</span><span class="p">(</span><span class="n">phase</span><span class="p">);</span>

<span class="w">        </span><span class="n">m_byte_array_agent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">byte_array_agent</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;m_byte_array_agent&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">        </span><span class="n">m_mfb_agent</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="n">mfb_agent</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;m_mfb_agent&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>

<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">connect_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>
<span class="w">        </span><span class="n">byte_array_mfb_monitor</span><span class="w"> </span><span class="n">mon</span><span class="p">;</span>

<span class="w">        </span><span class="p">$</span><span class="n">cast</span><span class="p">(</span><span class="n">mon</span><span class="p">,</span><span class="w"> </span><span class="n">m_byte_array_agent</span><span class="p">.</span><span class="n">m_monitor</span><span class="p">);</span>

<span class="w">        </span><span class="n">m_mfb_agent</span><span class="p">.</span><span class="n">analysis_port</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">mon</span><span class="p">.</span><span class="n">analysis_imp</span><span class="p">);</span>

<span class="w">        </span><span class="n">analysis_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_byte_array_agent</span><span class="p">.</span><span class="n">m_monitor</span><span class="p">.</span><span class="n">analysis_port</span><span class="p">;</span>
<span class="w">        </span><span class="n">m_sequencer</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">m_byte_array_agent</span><span class="p">.</span><span class="n">m_sequencer</span><span class="p">;</span>

<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">task</span><span class="w"> </span><span class="n">run_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// It is recommended to use the sequence library</span>
<span class="w">        </span><span class="n">byte_array_mfb_sequence</span><span class="w"> </span><span class="n">seq</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Create new sequence library</span>
<span class="w">        </span><span class="n">seq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">byte_array_mfb_sequence</span><span class="o">::</span><span class="n">type_ide</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;seq&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Connect high level sequencer to sequence.</span>
<span class="w">        </span><span class="n">seq</span><span class="p">.</span><span class="n">hl_sequencer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_byte_array_agent</span><span class="p">.</span><span class="n">m_sequencer</span><span class="p">;</span>

<span class="w">        </span><span class="k">forever</span><span class="w"> </span><span class="k">begin</span>

<span class="w">            </span><span class="n">seq</span><span class="p">.</span><span class="n">randomize</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// run sequence on low level sequencer</span>
<span class="w">            </span><span class="n">seq</span><span class="p">.</span><span class="n">start</span><span class="p">(</span><span class="n">m_mfb_agent</span><span class="p">.</span><span class="n">m_sequencer</span><span class="p">);</span>

<span class="w">        </span><span class="k">end</span>

<span class="w">    </span><span class="k">endtask</span>

<span class="kd">endclass</span>
</pre></div>
</div>
</section>
<section id="low-level-sequence">
<h3>Low-level sequence<a class="headerlink" href="#low-level-sequence" title="Link to this heading"></a></h3>
<p>The purpose of the low-level sequence is to create low-level sequence_items from
a high-level sequence_item. For example, we use byte_array as the high-level
sequence_item and 32bit word as the low-level transaction. The following example shows
how to parse high-level items into low-level items using a for loop. The
low-level sequence is going to run in the environment during the <em>run_phase</em>
task as was shown in the previous example.</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="k">task</span><span class="w"> </span><span class="n">body</span><span class="p">();</span>
<span class="w">    </span><span class="k">forever</span><span class="w"> </span><span class="k">begin</span>

<span class="w">        </span><span class="c1">//get higher level transaction from higher level sequencer</span>
<span class="w">        </span><span class="n">hl_sequencer</span><span class="p">.</span><span class="n">get_next_item</span><span class="p">(</span><span class="n">hl_item</span><span class="p">);</span>

<span class="w">        </span><span class="c1">//break hl_item into lower level transaction</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">hl_item</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">WORD_SIZE</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>

<span class="w">            </span><span class="n">start_item</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
<span class="w">            </span><span class="n">req</span><span class="p">.</span><span class="n">data</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">8</span><span class="p">{</span><span class="n">hl_item</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">it</span><span class="w"> </span><span class="o">+:</span><span class="w"> </span><span class="n">WORD_SIZE</span><span class="p">]}};</span>
<span class="w">            </span><span class="n">req</span><span class="p">.</span><span class="n">sof</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mb">1&#39;b0</span><span class="p">;</span>
<span class="w">            </span><span class="n">req</span><span class="p">.</span><span class="n">eof</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mb">1&#39;b0</span><span class="p">;</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">it</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">                </span><span class="n">req</span><span class="p">.</span><span class="n">sof</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mb">1&#39;b1</span><span class="p">;</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">it</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">WORD_SIZE</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">hl_item</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">size</span><span class="p">())</span>
<span class="w">                </span><span class="n">req</span><span class="p">.</span><span class="n">eof</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mb">1&#39;b1</span><span class="p">;</span>

<span class="w">            </span><span class="n">finish_item</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>

<span class="w">        </span><span class="k">end</span>

<span class="w">        </span><span class="c1">//send item done to higher level sequencer</span>
<span class="w">        </span><span class="n">hl_sequencer</span><span class="p">.</span><span class="n">item_done</span><span class="p">();</span>

<span class="w">    </span><span class="k">end</span>
<span class="k">endtask</span>
</pre></div>
</div>
</section>
<section id="high-level-monitor">
<h3>High-level monitor<a class="headerlink" href="#high-level-monitor" title="Link to this heading"></a></h3>
<p>The purpose of the high-level monitor is to create a high-level sequence_item
from low-level sequence_items. Unfortunately, the general high-level monitor
cannot cooperate with the low-level transaction. Therefore, the common approach
is to reimplement the high-level monitor and use the UVM configuration database
as shown in the previous example. Two important functions are performed: the
<em>build_phase</em> and the <em>connect_phase</em>. The <em>build_phase</em> function shows how to
use the reimplemented monitor with the UVM configuration database. The
<em>connect_phase</em> function shows how to connect the low-level monitor to the
high-level monitor.</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">byte_array_mfb_monitor</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">byte_array</span><span class="o">::</span><span class="n">monitor</span><span class="p">;</span>

<span class="w">    </span><span class="p">...</span>

<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">write</span><span class="p">(</span><span class="n">ll_transaction</span><span class="w"> </span><span class="n">tr</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// start of hl transaction</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tr</span><span class="p">.</span><span class="n">sof</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="n">fifo_data</span><span class="p">.</span><span class="n">delete</span><span class="p">();</span>
<span class="w">            </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ll_transaction</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;item&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">DATA_WIDTH</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="n">fifo_data</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">tr</span><span class="p">.</span><span class="n">data</span><span class="p">[(</span><span class="n">it</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">8</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="o">-:</span><span class="w"> </span><span class="mi">8</span><span class="p">]);</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">        </span><span class="c1">// end of hl transaction</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tr</span><span class="p">.</span><span class="n">eof</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">           </span><span class="n">item</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fifo_data</span>
<span class="w">           </span><span class="n">analysis_port</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="p">...</span>

<span class="kd">endclass</span>
</pre></div>
</div>
</section>
<section id="id1">
<h3>Configuration object<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<p>The environment creates one or multiple configuration objects for its
subenvironments or internal agents. The following example shows how to create
two configuration objects for agents which are instantiated in the current
environment.</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">env</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_env</span>

<span class="w">    </span><span class="p">...</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">build_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>

<span class="w">        </span><span class="n">byte_array_cfg</span><span class="w">      </span><span class="n">m_byte_array_cfg</span><span class="p">;</span>
<span class="w">        </span><span class="n">mfb_cfg</span><span class="w">             </span><span class="n">m_mfb_cfg</span><span class="p">;</span>

<span class="w">        </span><span class="n">uvm_config_db</span><span class="p">#(</span><span class="n">byte_array_mfb_cfg</span><span class="p">)</span><span class="o">::</span><span class="n">get</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;m_config&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_config</span><span class="p">);</span>

<span class="w">        </span><span class="c1">//save config object for subcomponent</span>
<span class="w">        </span><span class="n">m_byte_array_cfg</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">();</span>
<span class="w">        </span><span class="n">m_byte_array_cfg</span><span class="p">.</span><span class="n">active</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">m_config</span><span class="p">.</span><span class="n">active</span><span class="p">;</span>

<span class="w">        </span><span class="n">uvm_config_db</span><span class="p">#(</span><span class="n">byte_array_cfg</span><span class="p">)</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;m_byte_array_agent&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;m_config&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_byte_array_cfg</span><span class="p">);</span>

<span class="w">        </span><span class="n">m_mfb_cfg</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">();</span>
<span class="w">        </span><span class="n">m_mfb_cfg</span><span class="p">.</span><span class="n">active</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">m_config</span><span class="p">.</span><span class="n">active</span><span class="p">;</span>
<span class="w">        </span><span class="n">m_mfb_cfg</span><span class="p">.</span><span class="n">vif_name</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">m_config</span><span class="p">.</span><span class="n">vif_name</span><span class="p">;</span>

<span class="w">        </span><span class="n">uvm_config_db</span><span class="p">#(</span><span class="n">mfb_cfg</span><span class="p">)</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;m_mfb_agent&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;m_config&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_mfb_cfg</span><span class="p">);</span>

<span class="w">        </span><span class="c1">//create subcomponent</span>
<span class="w">        </span><span class="n">m_byte_array</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">byte_array</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;m_byte_array&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">        </span><span class="n">m_mfb_agent</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">mfb_agent</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;m_mfb_agent&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>

<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="p">...</span>

<span class="kd">endclass</span>
</pre></div>
</div>
<img alt="configuration object" class="align-center" src="../../_images/cofiguration_object.svg" />
</section>
<section id="id2">
<h3>Sequence library<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<p>It is recommended to use a sequence library as the lower sequence. This is going
to improve the coverage.</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">sequence_library</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_sequence_library</span><span class="p">;</span>
<span class="w">   </span><span class="no">`uvm_object_utils</span><span class="p">(</span><span class="n">byte_array_mfb</span><span class="o">::</span><span class="n">sequence_library</span><span class="p">)</span>
<span class="w">   </span><span class="no">`uvm_sequence_library_utils</span><span class="p">(</span><span class="n">byte_array_mfb</span><span class="o">::</span><span class="n">sequence_library</span><span class="p">)</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="w">        </span><span class="n">init_sequence_library</span><span class="p">();</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">init_sequence</span><span class="p">(</span><span class="n">config_sequence</span><span class="w"> </span><span class="n">param_cfg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">param_cfg</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="n">cfg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">();</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="n">cfg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">param_cfg</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">        </span><span class="c1">//run only this sequence</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="n">add_sequence</span><span class="p">(</span><span class="n">test</span><span class="o">::</span><span class="n">sequence_packet_small</span><span class="o">::</span><span class="n">get_type</span><span class="p">());</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="n">add_sequence</span><span class="p">(</span><span class="n">test</span><span class="o">::</span><span class="n">sequence_packet_mid</span><span class="o">::</span><span class="n">get_type</span><span class="p">());</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="n">add_sequence</span><span class="p">(</span><span class="n">test</span><span class="o">::</span><span class="n">sequence_packet_rand_spaces</span><span class="o">::</span><span class="n">get_type</span><span class="p">());</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="n">add_sequence</span><span class="p">(</span><span class="n">test</span><span class="o">::</span><span class="n">sequence_packet_constant</span><span class="o">::</span><span class="n">get_type</span><span class="p">());</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="n">add_sequence</span><span class="p">(</span><span class="n">test</span><span class="o">::</span><span class="n">sequence_packet_increment</span><span class="o">::</span><span class="n">get_type</span><span class="p">());</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="n">add_sequence</span><span class="p">(</span><span class="n">test</span><span class="o">::</span><span class="n">sequence_packet_large</span><span class="o">::</span><span class="n">get_type</span><span class="p">());</span>
<span class="w">   </span><span class="k">endfunction</span>

<span class="kd">endclass</span>
</pre></div>
</div>
</section>
<section id="run-of-a-specific-sequence">
<h3>Run of a specific sequence<a class="headerlink" href="#run-of-a-specific-sequence" title="Link to this heading"></a></h3>
<p>This example shows how to run a specific sequence on the lower sequencer in the
environment from the Test.</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">sequence_lib</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">byte_array_mfb</span><span class="o">::</span><span class="n">sequence_library</span><span class="p">;</span>
<span class="w">   </span><span class="no">`uvm_object_utils</span><span class="p">(</span><span class="n">test</span><span class="o">::</span><span class="n">sequence_lib</span><span class="p">)</span>
<span class="w">   </span><span class="no">`uvm_sequence_library_utils</span><span class="p">(</span><span class="n">test</span><span class="o">::</span><span class="n">sequence_lib</span><span class="p">)</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="w">        </span><span class="n">init_sequence_library</span><span class="p">();</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">init_sequence</span><span class="p">(</span><span class="n">config_sequence</span><span class="w"> </span><span class="n">param_cfg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">param_cfg</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="n">cfg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">();</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="n">cfg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">param_cfg</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">        </span><span class="c1">//run only this sequence</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="n">add_sequence</span><span class="p">(</span><span class="n">test</span><span class="o">::</span><span class="n">sequence_packet_large</span><span class="o">::</span><span class="n">get_type</span><span class="p">());</span>
<span class="w">   </span><span class="k">endfunction</span>

<span class="kd">endclass</span>
</pre></div>
</div>
<p>The code below shows how to change the sequence library using the UVM abstract
factory.</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">test</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_test</span><span class="p">;</span>

<span class="w">    </span><span class="p">...</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">build_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>

<span class="w">        </span><span class="c1">//change implementation</span>
<span class="w">        </span><span class="n">byte_array_mfb</span><span class="o">::</span><span class="n">sequence_lib</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">set_inst_override</span><span class="p">(</span><span class="n">sequence_lib</span><span class="o">::</span><span class="n">get_type</span><span class="p">(),</span><span class="w"> </span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="n">get_full_name</span><span class="p">()</span><span class="w"> </span><span class="p">,</span><span class="s">&quot;.m_env.rx_agent*&quot;</span><span class="p">});</span>

<span class="w">        </span><span class="p">...</span>

<span class="w">        </span><span class="c1">//create environment with change</span>
<span class="w">        </span><span class="n">m_env</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">component</span><span class="o">::</span><span class="n">env</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;m_env&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>

<span class="w">    </span><span class="k">endfunction</span>

<span class="kd">endclass</span>
</pre></div>
</div>
</section>
</section>
<section id="common-environment">
<h2>Common environment<a class="headerlink" href="#common-environment" title="Link to this heading"></a></h2>
<p>Environment (uvm_env) puts agents, subenvironments, and other components into a
logical unit. A common use of the environment is to connect the high-level agent
with the low-level one. The picture below shows an Environment with two agents,
one subenvironment containing a high-level agent connected to a low-level agent,
and one virtual sequencer.</p>
<img alt="environment" class="align-center" src="../../_images/enviroment.svg" />
<section id="virtual-sequencer">
<h3>Virtual sequencer<a class="headerlink" href="#virtual-sequencer" title="Link to this heading"></a></h3>
<p>A virtual sequencer connects all highest-level sequencers into one which runs a
virtual sequence. It serves to synchronize all highest-level sequencers (so the
agents start sending data at the same time). If the environment contains
subenvironments like in the previous picture, the virtual sequencer connects
only to the highest-level sequencer in each subenvironment.</p>
<img alt="virtual sequencer" class="align-center" src="../../_images/virtual_sequencer.svg" />
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">sequencer</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_sequencer</span><span class="p">;</span>
<span class="w">    </span><span class="no">`uvm_component_utils</span><span class="p">(</span><span class="n">env</span><span class="o">::</span><span class="n">sequencer</span><span class="p">)</span>

<span class="w">    </span><span class="n">mfb</span><span class="o">::</span><span class="n">sequencer</span><span class="w">          </span><span class="n">m_mfb_sequencer</span><span class="p">;</span>
<span class="w">    </span><span class="n">mvb</span><span class="o">::</span><span class="n">sequencer</span><span class="w">          </span><span class="n">m_mvb_sequencer</span><span class="p">;</span>
<span class="w">    </span><span class="k">config</span><span class="o">::</span><span class="n">sequencer</span><span class="w">       </span><span class="n">m_config_sequencer</span><span class="p">;</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">uvm_component</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">);</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="kd">endclass</span>
</pre></div>
</div>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">sequence_simple</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_sequence</span><span class="p">;</span>
<span class="w">    </span><span class="no">`uvm_object_param_utils</span><span class="p">(</span><span class="n">env</span><span class="o">::</span><span class="n">sequence_simple</span><span class="p">)</span>
<span class="w">    </span><span class="no">`uvm_declare_p_sequencer</span><span class="p">(</span><span class="w"> </span><span class="n">env</span><span class="o">::</span><span class="n">sequencer</span><span class="w"> </span><span class="p">)</span>

<span class="w">    </span><span class="c1">//sequence define</span>
<span class="w">    </span><span class="n">mfb</span><span class="o">::</span><span class="n">sequence_simple</span><span class="w">        </span><span class="n">mfb_sequence</span><span class="p">;</span>
<span class="w">    </span><span class="n">mvm</span><span class="o">::</span><span class="n">sequence_simple</span><span class="w">        </span><span class="n">mvb_sequence</span><span class="p">;</span>
<span class="w">    </span><span class="k">config</span><span class="o">::</span><span class="n">sequence_simple</span><span class="w">     </span><span class="n">config_sequence</span><span class="p">;</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">task</span><span class="w"> </span><span class="n">body</span><span class="p">();</span>
<span class="w">        </span><span class="k">fork</span>
<span class="w">            </span><span class="no">`uvm_do_on</span><span class="p">(</span><span class="n">mfb_sequence</span><span class="p">,</span><span class="w"> </span><span class="n">p_sequencer</span><span class="p">.</span><span class="n">m_mfb_sequencer</span><span class="p">);</span>
<span class="w">            </span><span class="no">`uvm_do_on</span><span class="p">(</span><span class="n">mvb_sequence</span><span class="p">,</span><span class="w"> </span><span class="n">p_sequencer</span><span class="p">.</span><span class="n">m_mvb_sequencer</span><span class="p">);</span>
<span class="w">            </span><span class="no">`uvm_do_on</span><span class="p">(</span><span class="n">config_sequence</span><span class="p">,</span><span class="w"> </span><span class="n">p_sequencer</span><span class="p">.</span><span class="n">m_config_sequencer</span><span class="p">);</span>
<span class="w">        </span><span class="k">join</span>
<span class="w">    </span><span class="k">endtask</span>

<span class="kd">endclass</span>
</pre></div>
</div>
</section>
<section id="virtual-sequence-and-synchronization">
<h3>Virtual sequence and synchronization<a class="headerlink" href="#virtual-sequence-and-synchronization" title="Link to this heading"></a></h3>
<p>TODO</p>
</section>
<section id="scoreboard">
<h3>Scoreboard<a class="headerlink" href="#scoreboard" title="Link to this heading"></a></h3>
<p>A Scoreboard is connected to the DUT, receives transactions from it, and
compares them with transactions received from a Model. Operations performed in a
Model (there can be more than one) are according to the DUT’s specified
(expected) behavior. The Model’s transactions are considered reference
transactions. Implementing the <strong>report_phase</strong> task enables the user (you) to
print arbitrary statistics at the end of the simulation to inform you about how
detailed the verification was. It is a good practice to write a uniform text
such as <em>VERIFICATION SUCCESS</em> when verification ends successfully. This can be
useful in automatic testing frameworks like <em>Jenkins</em>, etc.</p>
<p>Verification should check if the design is not stuck. For example, the DUT can
set all <em>RDY</em> or <em>VLD</em> signals to zero and not change them till the end of the
verification. This means that no packet passes through the design, which should
be reported by the verification. This check is prowided by systemverilog component
<strong>uvm_common::comparer_</strong></p>
<p>A Model should be implemented as an independent class. The example below shows
how should the Scoreboard and Model cooperate. The scoreboard only checks the
equality of the transactions. If the transactions are not equal, the Scoreboard
prints an error message through the UVM_error macro.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The UVM_error macro does not stop the verification. At the end of the
verification, the Scoreboard has to check if some errors occurred.</p>
</div>
<img alt="scoreboard" class="align-center" src="../../_images/scoreboard.svg" />
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">scoreboard</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_scoreboard</span><span class="p">;</span>
<span class="w">    </span><span class="no">`uvm_component_utils</span><span class="p">(</span><span class="n">env</span><span class="o">::</span><span class="n">scoreboard</span><span class="p">)</span>

<span class="w">    </span><span class="c1">//CONNECT DUT</span>
<span class="w">    </span><span class="n">uvm_analysis_export</span><span class="w"> </span><span class="p">#(</span><span class="n">packet</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">)</span><span class="w">    </span><span class="n">analysis_export_rx</span><span class="p">;</span>
<span class="w">    </span><span class="n">uvm_analysis_export</span><span class="w"> </span><span class="p">#(</span><span class="n">packet</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">)</span><span class="w">    </span><span class="n">analysis_export_tx</span><span class="p">;</span>

<span class="w">    </span><span class="c1">//output fifos</span>
<span class="w">    </span><span class="k">protected</span><span class="w"> </span><span class="n">uvm_common</span><span class="o">::</span><span class="n">comparer_ordered</span><span class="p">#(</span><span class="n">packet</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">)</span><span class="w"> </span><span class="n">m_comparer</span><span class="p">;</span>
<span class="w">    </span><span class="c1">//models</span>
<span class="w">    </span><span class="k">protected</span><span class="w"> </span><span class="n">model</span><span class="w">   </span><span class="n">m_model</span><span class="p">;</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">uvm_component</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">);</span>

<span class="w">      </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">);</span>

<span class="w">      </span><span class="n">analysis_export_rx</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="s">&quot;analysis_imp_rx&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">      </span><span class="n">analysis_export_tx</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="s">&quot;analysis_imp_tx&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">build_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>
<span class="w">        </span><span class="n">m_comparer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvm_common</span><span class="o">::</span><span class="n">comparer_ordered</span><span class="p">#(</span><span class="n">packet</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">)</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;m_comparer&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">        </span><span class="n">m_model</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;m_model&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">        </span><span class="c1">//lot of dut connection between components isnt 1 to 1 but with small change. with this fifos</span>
<span class="w">        </span><span class="c1">//it can be made with models too.</span>
<span class="w">        </span><span class="n">m_model</span><span class="p">.</span><span class="k">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fifo_model_input</span><span class="p">#(</span><span class="n">packet</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">)</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;input&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m_model</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">connect_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>
<span class="w">        </span><span class="n">fifo_model_input</span><span class="p">#(</span><span class="n">packet</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">)</span><span class="w"> </span><span class="n">model_in</span><span class="p">;</span>

<span class="w">        </span><span class="p">$</span><span class="n">cast</span><span class="p">(</span><span class="n">model_in</span><span class="p">,</span><span class="w"> </span><span class="n">m_model</span><span class="p">.</span><span class="k">input</span><span class="p">);</span>
<span class="w">        </span><span class="n">analysis_export_rx</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">model_in</span><span class="p">.</span><span class="n">anlysis_export</span><span class="p">);</span>
<span class="w">        </span><span class="n">analysis_export_tx</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">m_comparer</span><span class="p">.</span><span class="n">analysis_imp_dut</span><span class="p">);</span>
<span class="w">        </span><span class="n">m_model</span><span class="p">.</span><span class="k">output</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">m_comparer</span><span class="p">.</span><span class="n">analysis_imp_model</span><span class="p">);</span>

<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">report_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_comparer</span><span class="p">.</span><span class="n">success</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m_comparer</span><span class="p">.</span><span class="n">used</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="no">`uvm_info</span><span class="p">(</span><span class="n">get_type_name</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n\t</span><span class="s">---------------------------------------</span><span class="se">\n\t</span><span class="s">----     VERIFICATION SUCCESS      ----</span><span class="se">\n\t</span><span class="s">---------------------------------------&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">UVM_NONE</span><span class="p">)</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="no">`uvm_info</span><span class="p">(</span><span class="n">get_type_name</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n\t</span><span class="s">---------------------------------------</span><span class="se">\n\t</span><span class="s">----     VERIFICATION FAIL      ----</span><span class="se">\n\t</span><span class="s">---------------------------------------&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">UVM_NONE</span><span class="p">)</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">    </span><span class="k">endfunction</span>
<span class="kd">endclass</span>
</pre></div>
</div>
</section>
</section>
<section id="request-response-agents">
<h2>Request-response Agents<a class="headerlink" href="#request-response-agents" title="Link to this heading"></a></h2>
<p>Some agents may require bidirectional communications. For this purpose, the UVM
has the Request-Response mechanism.</p>
<p>For example, the read request on MI has two transactions. The first transaction
is from a master to a slave (the request) and the second transaction is a
response from that slave back to the master.</p>
<img alt="question response" class="align-center" src="../../_images/MI_agent.svg" />
</section>
<section id="reset">
<h2>Reset<a class="headerlink" href="#reset" title="Link to this heading"></a></h2>
<p>One possible solution to the problem when a reset is generated in the middle of
the verification (not only at its start) is to use the wait task to wait for all
required inputs. An example is provided below showing this type of the solution.
However, there is a problem taking place when the process reads the input A and
waits for the input B, then the reset happens and all data should be flushed.</p>
</section>
<section id="id3">
<h2>Scoreboard<a class="headerlink" href="#id3" title="Link to this heading"></a></h2>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">scoreboard</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_scoreboard</span><span class="p">;</span>
<span class="w">    </span><span class="no">`uvm_component_utils</span><span class="p">(</span><span class="n">env</span><span class="o">::</span><span class="n">scoreboard</span><span class="p">)</span>

<span class="w">    </span><span class="n">uvm_analysis_imp_reset</span><span class="p">#(</span><span class="n">reset</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">,</span><span class="w"> </span><span class="n">scoreboard</span><span class="p">)</span><span class="w">   </span><span class="n">analysis_imp_reset</span><span class="p">;</span>
<span class="w">    </span><span class="k">protected</span><span class="w"> </span><span class="n">model</span><span class="w">                                             </span><span class="n">m_model</span><span class="p">;</span>
<span class="w">    </span><span class="k">protected</span><span class="w"> </span><span class="n">uvm_common</span><span class="o">::</span><span class="n">comparer_ordered</span><span class="p">#(</span><span class="n">packet</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">)</span><span class="w"> </span><span class="n">m_comparer</span><span class="p">;</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">uvm_component</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">);</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">);</span>
<span class="w">        </span><span class="n">analysis_imp_reset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="s">&quot;analysis_imp_reset&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">write_reset</span><span class="p">(</span><span class="n">reset</span><span class="o">::</span><span class="n">sequence_item</span><span class="w"> </span><span class="n">tr</span><span class="p">);</span>

<span class="w">        </span><span class="c1">//RESET</span>
<span class="w">        </span><span class="n">m_comparer</span><span class="p">.</span><span class="n">flush</span><span class="p">();</span>
<span class="w">        </span><span class="n">m_regmodel</span><span class="p">.</span><span class="n">reset</span><span class="p">();</span>
<span class="w">        </span><span class="n">m_model</span><span class="p">.</span><span class="n">reset</span><span class="p">();</span>
<span class="w">    </span><span class="k">endfunction</span>
<span class="kd">endclass</span>
</pre></div>
</div>
</section>
<section id="coverage">
<h2>Coverage<a class="headerlink" href="#coverage" title="Link to this heading"></a></h2>
<p>Coverage is one of the essential metrics for checking a verification status.
Coverage can tell whether the verification of the design has been done properly
or not. Every verification should check whether its coverage is high enough. If
it’s not, the verification engineer should explain why.</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">output_cover</span><span class="w"> </span><span class="p">#(</span><span class="n">OUTPUTS</span><span class="p">)</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_subscriber</span><span class="p">#(</span><span class="n">sequence_item</span><span class="p">);</span>
<span class="w">    </span><span class="no">`uvm_component_param_utils</span><span class="p">(</span><span class="n">packet_port_env</span><span class="o">::</span><span class="n">output_cover</span><span class="w"> </span><span class="p">#(</span><span class="n">OUTPUTS</span><span class="p">))</span>

<span class="w">    </span><span class="n">sequence_item</span><span class="w">   </span><span class="n">item</span><span class="p">;</span>

<span class="w">    </span><span class="k">covergroup</span><span class="w"> </span><span class="n">cov_packet</span><span class="p">;</span>

<span class="w">        </span><span class="n">items_size</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">coverpoint</span><span class="w"> </span><span class="n">item</span><span class="p">.</span><span class="n">packet</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">bins</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="mi">512</span><span class="p">]</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="p">{[</span><span class="mi">0</span><span class="o">:</span><span class="mi">2</span><span class="o">****</span><span class="mi">16</span><span class="o">-</span><span class="mi">1</span><span class="p">]};</span>
<span class="w">            </span><span class="k">illegal_bins</span><span class="w"> </span><span class="n">others</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">items_port</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">coverpoint</span><span class="w"> </span><span class="n">item</span><span class="p">.</span><span class="n">port</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">bins</span><span class="w"> </span><span class="n">num</span><span class="p">[</span><span class="n">OUTPUTS</span><span class="p">]</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="p">{[</span><span class="mi">0</span><span class="o">:</span><span class="n">OUTPUTS</span><span class="o">-</span><span class="mi">1</span><span class="p">]};</span>
<span class="w">            </span><span class="k">illegal_bins</span><span class="w"> </span><span class="n">others</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">cross</span><span class="w"> </span><span class="n">items_size</span><span class="p">,</span><span class="w"> </span><span class="n">items_port</span><span class="p">;</span>

<span class="w">    </span><span class="k">endgroup</span>

<span class="w">    </span><span class="p">...</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">write</span><span class="p">(</span><span class="n">sequence_item</span><span class="w"> </span><span class="n">tr</span><span class="p">);</span>
<span class="w">        </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tr</span><span class="p">;</span>
<span class="w">        </span><span class="n">cov_packet</span><span class="p">.</span><span class="n">sample</span><span class="p">();</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="kd">endclass</span>
</pre></div>
</div>
<section id="functional-coverage">
<h3>Functional coverage<a class="headerlink" href="#functional-coverage" title="Link to this heading"></a></h3>
<p>Every model should contain a functional coverage to check if all of its
functionalities have been tested (if all instances/states that could occur have
occurred). Functional coverage can be measured in the model.</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">coverage_base</span><span class="w"> </span><span class="kd">extends</span><span class="w">  </span><span class="nc">uvm_subscriber</span><span class="p">#(</span><span class="n">sequence_item</span><span class="p">);</span>

<span class="w">    </span><span class="n">sequence_item</span><span class="w"> </span><span class="n">item</span><span class="p">;</span>

<span class="w">    </span><span class="k">covergroup</span><span class="w"> </span><span class="n">m_cov</span><span class="p">;</span>
<span class="w">        </span><span class="nl">ones:</span><span class="w"> </span><span class="k">coverpoint</span><span class="w"> </span><span class="p">$</span><span class="n">countones</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="n">mash</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">bins</span><span class="w"> </span><span class="n">ones</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{[</span><span class="mi">0</span><span class="o">:</span><span class="mi">20</span><span class="p">]};</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="k">endgroup</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">uvm_component</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">);</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">);</span>
<span class="w">        </span><span class="n">m_cov</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">();</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">write</span><span class="p">(</span><span class="n">sequence_item</span><span class="w"> </span><span class="n">t</span><span class="p">);</span>
<span class="w">        </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="w">        </span><span class="n">m_cov</span><span class="p">.</span><span class="n">sample</span><span class="p">();</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="kd">endclass</span>
</pre></div>
</div>
</section>
<section id="code-coverage">
<h3>Code coverage<a class="headerlink" href="#code-coverage" title="Link to this heading"></a></h3>
<p>In contrast to the functional coverage, code coverage reports how many lines,
conditional jumps and expressions were checked during the verification.</p>
<p>A simple metric is usually generated by the verification tool. In the OFM
verification environment, this can be set up by adding <em>set
SIM_FLAGS(CODE_COVERAGE) “true”</em> into the <em>top_level.fdo</em> simulation macro.</p>
</section>
<section id="generating-coverage-reports">
<h3>Generating coverage reports<a class="headerlink" href="#generating-coverage-reports" title="Link to this heading"></a></h3>
<p>ModelSim can generate coverage reports in the HTML format:</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="nv">coverage</span><span class="w"> </span>report<span class="w"> </span><span class="o">-</span>html<span class="w"> </span><span class="o">-</span>output<span class="w"> </span>cov_html<span class="w"> </span><span class="o">-</span>instance<span class="err">=</span><span class="o">/</span>testbench<span class="o">/</span>DUT_U<span class="w"> </span><span class="o">-</span>annotate<span class="w"> </span><span class="o">-</span>details<span class="w"> </span><span class="o">-</span>assert<span class="w"> </span><span class="o">-</span>directive<span class="w"> </span><span class="o">-</span>cvg<span class="w"> </span><span class="o">-</span>code<span class="w"> </span>bcefst<span class="w"> </span><span class="o">-</span>verbose<span class="w"> </span><span class="o">-</span>threshL<span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="o">-</span>threshH<span class="w"> </span><span class="mi">90</span>
</pre></div>
</div>
<p>Multiple reports from one simulation can be merged into one:</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="nv">coverage</span><span class="w"> </span>save<span class="w"> </span><span class="o">-</span>instance<span class="w"> </span><span class="o">/</span>testbench<span class="o">/</span>DUT_U<span class="w"> </span><span class="o">-</span>assert<span class="w"> </span><span class="o">-</span>directive<span class="w"> </span><span class="o">-</span>cvg<span class="w"> </span><span class="o">-</span>code<span class="w"> </span>bcefst<span class="w"> </span><span class="o">-</span>verbose<span class="w"> </span>actual.ucdb
<span class="nv">vcover</span><span class="w"> </span>merge<span class="w"> </span>final.ucdb<span class="w"> </span>final.ucdb<span class="w"> </span>actual.ucdb
<span class="nv">vcover</span><span class="w"> </span>report<span class="w"> </span><span class="o">-</span>html<span class="w"> </span><span class="o">-</span>output<span class="w"> </span>cov_html<span class="w"> </span><span class="o">-</span>details<span class="w"> </span><span class="o">-</span>threshL<span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="o">-</span>threshH<span class="w"> </span><span class="mi">90</span><span class="w"> </span>final.ucdb
</pre></div>
</div>
<p>Comments to each line:</p>
<ol class="arabic simple">
<li><p>(This command is for the multiver script.) Save the coverage after every
simulation into actual.ucdb.</p></li>
<li><p>Merge coverage from the current simulation with others that were created
earlier.</p></li>
<li><p>Generate the HTML output.</p></li>
</ol>
</section>
</section>
<section id="verification-example">
<h2>Verification example<a class="headerlink" href="#verification-example" title="Link to this heading"></a></h2>
<p>In this example, we introduce the MFB splitter component which divides a single
MFB input stream into N MFB output streams. With every incoming packet on the
MFB comes also information about the output port. That information is received
on the MVB interface. For the sake of simplicity, the MVB interface is not
aligned to the MFB. The FIFO method is used so the solution only depends on the
ordering of the MFB and MVB streams.</p>
<p>The following image shows the connections between the blocks of such verification:</p>
<img alt="Verification connection" class="align-center" src="../../_images/mfb_splitter.svg" />
<section id="byte-array-port-environment">
<h3>Byte_array_port environment<a class="headerlink" href="#byte-array-port-environment" title="Link to this heading"></a></h3>
<p>The environment is used for grouping the byte_array and the port. The advantage of this
approach lies in generating data for the MVB and the MFB in one roll.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please always use uvm_logic_vector_array instead byte_array</p>
</div>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">sequence_item</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_sequence_item</span><span class="p">;</span>
<span class="w">    </span><span class="no">`uvm_object_utils</span><span class="p">(</span><span class="n">byte_array_port_env</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">)</span>

<span class="w">    </span><span class="k">rand</span><span class="w"> </span><span class="n">byte_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="w"> </span><span class="n">packet</span><span class="p">;</span>
<span class="w">    </span><span class="k">rand</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w">              </span><span class="n">port</span><span class="p">;</span>

<span class="w">    </span><span class="p">...</span>

<span class="kd">endclass</span>
</pre></div>
</div>
<p>Because it is required to divide the high-level sequence, we cannot use a
pointer directly to the high-level sequencer. Instead of that, we use the driver
to divide each sequence into two pieces.</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">driver</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_driver</span><span class="p">#(</span><span class="n">sequence_item</span><span class="p">);</span>
<span class="w">   </span><span class="no">`uvm_component_utils</span><span class="p">(</span><span class="n">byte_array_port_env</span><span class="o">::</span><span class="n">driver</span><span class="p">)</span>

<span class="w">   </span><span class="n">mailbox</span><span class="p">#(</span><span class="n">byte_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">)</span><span class="w">     </span><span class="n">msg_byte_array</span><span class="p">;</span>
<span class="w">   </span><span class="n">mailbox</span><span class="p">#(</span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="p">)</span><span class="w">                  </span><span class="n">msg_port</span><span class="p">;</span>

<span class="w">   </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">uvm_component</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">);</span>
<span class="w">       </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">);</span>

<span class="w">       </span><span class="n">msg_byte_array</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w"> </span><span class="c1">//max 10 requests</span>
<span class="w">       </span><span class="n">msg_port</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>

<span class="w">   </span><span class="k">endfunction</span>

<span class="w">   </span><span class="k">task</span><span class="w"> </span><span class="n">run_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>

<span class="w">       </span><span class="n">byte_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="w">    </span><span class="n">tr_paket</span><span class="p">;</span>
<span class="w">       </span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w">                 </span><span class="n">tr_port</span><span class="p">;</span>

<span class="w">       </span><span class="k">forever</span><span class="w"> </span><span class="k">begin</span>

<span class="w">           </span><span class="n">seq_item_port</span><span class="p">.</span><span class="n">get_next_item</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
<span class="w">           </span><span class="n">tr_paket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">req</span><span class="p">.</span><span class="n">paket</span><span class="p">.</span><span class="n">clone</span><span class="p">();</span>

<span class="w">           </span><span class="n">msg_byte_array</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="n">tr_paket</span><span class="p">);</span>
<span class="w">           </span><span class="n">tr_port</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">req</span><span class="p">.</span><span class="n">port</span><span class="p">;</span>

<span class="w">           </span><span class="n">msg_port</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="n">tr_port</span><span class="p">);</span>
<span class="w">           </span><span class="n">seq_item_port</span><span class="p">.</span><span class="n">item_done</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
<span class="w">       </span><span class="k">end</span>

<span class="w">   </span><span class="k">endtask</span>

<span class="kd">endclass</span>
</pre></div>
</div>
<p>The environment contains two sequences: One to generate
<em>byte_array::sequence_item</em> and the second to generate <em>mvb::sequence_item</em>.</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">sequence_byte_array</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_sequence</span><span class="p">#(</span><span class="n">byte_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">);</span>
<span class="w">    </span><span class="no">`uvm_object_utils</span><span class="p">(</span><span class="n">byte_array_port_env</span><span class="o">::</span><span class="n">sequence_byte_array</span><span class="p">)</span>

<span class="w">    </span><span class="n">mailbox</span><span class="p">#(</span><span class="n">byte_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">)</span><span class="w"> </span><span class="n">in_data</span><span class="p">;</span>

<span class="w">    </span><span class="p">...</span>

<span class="w">    </span><span class="k">task</span><span class="w"> </span><span class="n">body</span><span class="p">();</span>

<span class="w">        </span><span class="k">forever</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="n">in_data</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
<span class="w">            </span><span class="n">start_item</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
<span class="w">            </span><span class="n">finish_item</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">    </span><span class="k">endtask</span>

<span class="kd">endclass</span>
</pre></div>
</div>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">sequence_mvb</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_sequence</span><span class="p">#(</span><span class="n">mvb</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">);</span>
<span class="w">    </span><span class="no">`uvm_object_utils</span><span class="p">(</span><span class="n">byte_array_port_env</span><span class="o">::</span><span class="n">sequence_mvb</span><span class="p">)</span>

<span class="w">    </span><span class="n">mailbox</span><span class="p">#(</span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="p">)</span><span class="w"> </span><span class="n">in_data</span><span class="p">;</span>

<span class="w">    </span><span class="p">...</span>

<span class="w">    </span><span class="k">task</span><span class="w"> </span><span class="n">body</span><span class="p">();</span>

<span class="w">        </span><span class="n">req</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvb</span><span class="o">::</span><span class="n">sequence_item</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;byte_array_port_env::mvb&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">mvb_valid_items</span><span class="p">;</span>

<span class="w">        </span><span class="k">forever</span><span class="w"> </span><span class="k">begin</span>

<span class="w">            </span><span class="kt">bit</span><span class="w"> </span><span class="n">rdy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">            </span><span class="n">start_item</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
<span class="w">            </span><span class="n">req</span><span class="p">.</span><span class="n">randomize</span><span class="p">();</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">REGIONS</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">req</span><span class="p">.</span><span class="n">vld</span><span class="p">[</span><span class="n">it</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">in_data</span><span class="p">.</span><span class="n">num</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">                    </span><span class="n">rdy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">                    </span><span class="n">in_data</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">req</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">it</span><span class="p">]);</span>
<span class="w">                </span><span class="k">end</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">begin</span>
<span class="w">                    </span><span class="n">req</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">it</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">&#39;x</span>
<span class="w">                </span><span class="k">end</span>

<span class="w">            </span><span class="k">end</span>

<span class="w">            </span><span class="n">req</span><span class="p">.</span><span class="n">rdy</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="n">rdy</span><span class="p">;</span>

<span class="w">            </span><span class="n">finish_item</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">    </span><span class="k">endtask</span>

<span class="kd">endclass</span>
</pre></div>
</div>
<p>The following code shows how to put it all together:</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">env</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_env</span><span class="p">;</span>
<span class="w">    </span><span class="no">`uvm_component_utils</span><span class="p">(</span><span class="n">byte_array_port_env</span><span class="o">::</span><span class="n">env</span><span class="p">)</span>

<span class="w">    </span><span class="n">sequencer</span><span class="w">   </span><span class="n">m_sequencer</span><span class="p">;</span>
<span class="w">    </span><span class="n">driver</span><span class="w">      </span><span class="n">m_driver</span><span class="p">;</span>
<span class="w">    </span><span class="n">monitor</span><span class="w">     </span><span class="n">m_monitor</span><span class="p">;</span>

<span class="w">    </span><span class="c1">//low level agents</span>
<span class="w">    </span><span class="n">byte_array_mfb</span><span class="o">::</span><span class="n">agent</span><span class="w">   </span><span class="n">byte_array_agent</span><span class="p">;</span>
<span class="w">    </span><span class="n">mvb</span><span class="o">::</span><span class="n">agent</span><span class="w">              </span><span class="n">mvb_agent</span><span class="p">;</span>

<span class="w">    </span><span class="p">...</span>

<span class="w">    </span><span class="k">task</span><span class="w"> </span><span class="n">run_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>

<span class="w">       </span><span class="n">sequence_byte_array</span><span class="w">  </span><span class="n">seq_byte_array</span><span class="p">;</span>
<span class="w">       </span><span class="n">sequence_mvb</span><span class="w">         </span><span class="n">seq_mvb</span><span class="p">;</span>

<span class="w">       </span><span class="n">seq_byte_array</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="n">sequence_byte_array</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;sequence_byte_array&quot;</span><span class="p">);</span>
<span class="w">       </span><span class="n">seq_byte_array</span><span class="p">.</span><span class="n">in_data</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">m_driver</span><span class="p">.</span><span class="n">msg_byte_array</span><span class="p">;</span>
<span class="w">       </span><span class="n">seq_mvb</span><span class="w">                  </span><span class="o">=</span><span class="w"> </span><span class="n">sequence_mvb</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;sequence_mvb&quot;</span><span class="p">);</span>
<span class="w">       </span><span class="n">seq_mvb</span><span class="p">.</span><span class="n">in_data</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="n">m_driver</span><span class="p">.</span><span class="n">msg_mvb</span><span class="p">;</span>

<span class="w">       </span><span class="k">fork</span>
<span class="w">           </span><span class="n">seq_byte_array</span><span class="p">.</span><span class="n">start</span><span class="p">(</span><span class="n">byte_array_agent</span><span class="p">.</span><span class="n">m_sequencer</span><span class="p">);</span>
<span class="w">           </span><span class="n">seq_mvb</span><span class="p">.</span><span class="n">start</span><span class="p">(</span><span class="n">mvb_agent</span><span class="p">.</span><span class="n">m_sequencer</span><span class="p">);</span>
<span class="w">       </span><span class="k">join</span>

<span class="w">    </span><span class="k">endtask</span>

<span class="kd">endclass</span>
</pre></div>
</div>
</section>
<section id="model">
<h3>Model<a class="headerlink" href="#model" title="Link to this heading"></a></h3>
<p>Inputs and outputs of the model are implemented by the Transaction Level Model
(TLM) in the UVM where the <em>uvm_analysis_*</em>, <em>uvm_tlm_analysis_*</em> macros are used.</p>
<p>The model can have a slightly different output and input than the DUT. The reason for this
is better code readability. For the model, you don’t always need variables of the same width,
so you can use integers instead logic [10:0] and have better structures. This approach
has one disadvantage. You cannot simply have two models because they can have slightly different
outputs and inputs. This can make it impossible to connect two models. For this reason,
the model should use the uvm_common::fifo#(FIFO_TYPE) component for the inputs. The model doesn’t create
the FIFO, it just creates a value, and the FIFO will be created by a higher component. More info
is in the components documentation in the FIFO section. <span class="xref std std-ref">uvm_common::fifo</span></p>
<p>Sometimes it is required to pass meta-information through models. The uvm_common::model_item#(TYPE_ITEM)
class is created for some information. This class provides three variables.
The first variable, <cite>start,</cite> is an associative array where the input time of each
source transaction can be stored. This is very useful for an HDL developer. The second
variable is a tag that contains a string tag. Tag is useful when merging two streams into one.
Then the merged output can be <strong>out</strong> of order, but data from one stream have to be <strong>in</strong> order.
Then in the tag, the name of the input interface can be stored. More info can be found in the component documentation
in the <cite>comparer</cite> (tagged) section. The third variable is the required transaction.
Another problem can be when we have one model that contains other models, one of which should discard packets. One approach is to create the discarding logic. However, this might be quite difficult in some cases. A different approach is to assume that the DUT discards the packets
correctly. Then we can tap the inner discard signal of the DUT and use its
values to discard the packets in the model.</p>
<p>Verification of
<a class="reference external" href="https://github.com/CESNET/ndk-core/tree/main/intel/src/comp/network_mod/comp/network_mod_logic/uvm">Network Module Logic</a>.
is example of how you can impement model.</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w">  </span><span class="nc">model_item</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_sequence_item</span><span class="p">;</span>
<span class="w">    </span><span class="no">`uvm_object_utils</span><span class="p">(</span><span class="n">packet_splitter</span><span class="o">::</span><span class="n">model_item</span><span class="p">)</span>
<span class="w">    </span><span class="n">uvm_logic_vector_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">port</span><span class="p">;</span>

<span class="w">    </span><span class="p">...</span>
<span class="kd">endclass</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">model</span><span class="p">#(</span><span class="n">PORTS</span><span class="p">)</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_component</span><span class="p">;</span>
<span class="w">    </span><span class="no">`uvm_component_param_utils</span><span class="p">(</span><span class="n">packet_splitter</span><span class="o">::</span><span class="n">model</span><span class="p">#(</span><span class="n">PORTS</span><span class="p">))</span>

<span class="w">    </span><span class="n">uvm_common</span><span class="o">::</span><span class="n">fifo</span><span class="p">#(</span><span class="n">uvm_common</span><span class="o">::</span><span class="n">model_item</span><span class="p">#(</span><span class="n">model_item</span><span class="p">))</span><span class="w">   </span><span class="k">input</span><span class="p">;</span>
<span class="w">    </span><span class="n">uvm_analysis_port</span><span class="p">#(</span><span class="n">uvm_common</span><span class="o">::</span><span class="n">model_item</span><span class="p">#(</span><span class="n">uvm_logic_vector_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="mi">8</span><span class="p">)))</span><span class="w">   </span><span class="k">output</span><span class="p">[</span><span class="n">PORTS</span><span class="p">];</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">uvm_component</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">);</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">);</span>

<span class="w">        </span><span class="k">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">;</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">PORTS</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="kt">string</span><span class="w"> </span><span class="n">it_num</span><span class="p">;</span>
<span class="w">            </span><span class="n">it_num</span><span class="p">.</span><span class="n">itoa</span><span class="p">(</span><span class="n">it</span><span class="p">);</span>
<span class="w">            </span><span class="k">output</span><span class="p">[</span><span class="n">it</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">({</span><span class="s">&quot;sc_output_&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">it_num</span><span class="p">},</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">task</span><span class="w"> </span><span class="n">run_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="p">);</span>

<span class="w">        </span><span class="n">uvm_common</span><span class="o">::</span><span class="n">model_item</span><span class="p">#(</span><span class="n">model_item</span><span class="p">)</span><span class="w"> </span><span class="n">tr</span><span class="p">;</span>
<span class="w">        </span><span class="n">uvm_common</span><span class="o">::</span><span class="n">model_item</span><span class="p">#(</span><span class="n">uvm_logic_vector_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="mi">8</span><span class="p">))</span><span class="w"> </span><span class="n">tr_out</span><span class="p">;</span>

<span class="w">        </span><span class="k">forever</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="k">input</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">tr</span><span class="p">);</span>

<span class="w">            </span><span class="n">tr_out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvm_common</span><span class="o">::</span><span class="n">model_item</span><span class="p">#(</span><span class="n">uvm_logic_vector_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="mi">8</span><span class="p">))</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;tr_out&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">            </span><span class="n">tr_out</span><span class="p">.</span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvm_logic_vector_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="mi">8</span><span class="p">)</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;tr_out.item&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">            </span><span class="n">tr_out</span><span class="p">.</span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tr</span><span class="p">.</span><span class="n">start</span><span class="p">;</span>
<span class="w">            </span><span class="n">tr_out</span><span class="p">.</span><span class="n">tag</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">tr</span><span class="p">.</span><span class="n">tag</span><span class="p">;</span>
<span class="w">            </span><span class="n">tr_out</span><span class="p">.</span><span class="n">item</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">tr</span><span class="p">.</span><span class="n">item</span><span class="p">.</span><span class="n">data</span>
<span class="w">            </span><span class="c1">//model write packet to output</span>
<span class="w">            </span><span class="k">output</span><span class="p">[</span><span class="n">tr</span><span class="p">.</span><span class="n">item</span><span class="p">.</span><span class="n">port</span><span class="p">].</span><span class="n">write</span><span class="p">(</span><span class="n">tr</span><span class="p">.</span><span class="n">packet</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">    </span><span class="k">endtask</span>

<span class="kd">endclass</span>
</pre></div>
</div>
</section>
<section id="create-model-input-fifo">
<h3>Create model input fifo<a class="headerlink" href="#create-model-input-fifo" title="Link to this heading"></a></h3>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="no">`uvm_analysis_imp_decl</span><span class="p">(</span><span class="n">_data</span><span class="p">)</span>
<span class="no">`uvm_analysis_imp_decl</span><span class="p">(</span><span class="n">_meta</span><span class="p">)</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">model_input_fifo</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">META_WIDTH</span><span class="p">)</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_common</span><span class="o">::</span><span class="n">fifo</span><span class="p">#(</span><span class="n">uvm_common</span><span class="o">::</span><span class="n">model_item</span><span class="p">#(</span><span class="n">model_data</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">META_WIDTH</span><span class="p">)));</span>
<span class="w">    </span><span class="no">`uvm_component_param_utils</span><span class="p">(</span><span class="n">net_mod_logic_env</span><span class="o">::</span><span class="n">model_input_fifo</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">META_WIDTH</span><span class="p">))</span>

<span class="w">    </span><span class="k">typedef</span><span class="w"> </span><span class="n">model_input_fifo</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">META_WIDTH</span><span class="p">)</span><span class="w"> </span><span class="n">this_type</span><span class="p">;</span>
<span class="w">    </span><span class="n">uvm_analysis_imp_data</span><span class="p">#(</span><span class="n">uvm_logic_vector_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">),</span><span class="w"> </span><span class="n">this_type</span><span class="p">)</span><span class="w"> </span><span class="n">analysis_export_data</span><span class="p">;</span>
<span class="w">    </span><span class="n">uvm_analysis_imp_meta</span><span class="p">#(</span><span class="n">uvm_logic_vector</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="n">META_WIDTH</span><span class="p">),</span><span class="w">       </span><span class="n">this_type</span><span class="p">)</span><span class="w"> </span><span class="n">analysis_export_meta</span><span class="p">;</span>

<span class="w">    </span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">uvm_logic_vector_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">)</span><span class="w"> </span><span class="n">input_item</span><span class="p">;</span>
<span class="w">        </span><span class="kt">time</span><span class="w">  </span><span class="n">input_time</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">data_item</span><span class="p">;</span>

<span class="w">    </span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">uvm_logic_vector</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="n">META_WIDTH</span><span class="p">)</span><span class="w"> </span><span class="n">input_item</span><span class="p">;</span>
<span class="w">        </span><span class="kt">time</span><span class="w">  </span><span class="n">input_time</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">meta_item</span><span class="p">;</span>

<span class="w">    </span><span class="k">protected</span><span class="w"> </span><span class="n">data_item</span><span class="w"> </span><span class="n">tmp_data</span><span class="p">[$];</span>
<span class="w">    </span><span class="k">protected</span><span class="w"> </span><span class="n">meta_item</span><span class="w"> </span><span class="n">tmp_meta</span><span class="p">[$];</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">uvm_component</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">);</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">);</span>
<span class="w">        </span><span class="n">analysis_export_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="s">&quot;analysis_export_data&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">        </span><span class="n">analysis_export_meta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="s">&quot;analysis_export_meta&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">write_data</span><span class="p">(</span><span class="n">uvm_logic_vector_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">)</span><span class="w"> </span><span class="n">t</span><span class="p">);</span>
<span class="w">        </span><span class="n">tmp_data</span><span class="p">.</span><span class="n">push_back</span><span class="p">(&#39;{</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="p">$</span><span class="kt">time</span><span class="p">()});</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">write_meta</span><span class="p">(</span><span class="n">uvm_logic_vector</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="n">META_WIDTH</span><span class="p">)</span><span class="w"> </span><span class="n">t</span><span class="p">);</span>
<span class="w">        </span><span class="n">tmp_meta</span><span class="p">.</span><span class="n">push_back</span><span class="p">(&#39;{</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="p">$</span><span class="kt">time</span><span class="p">()});</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">task</span><span class="w"> </span><span class="n">run_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>
<span class="w">        </span><span class="n">uvm_common</span><span class="o">::</span><span class="n">model_item</span><span class="p">#(</span><span class="n">model_data</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">META_WIDTH</span><span class="p">))</span><span class="w"> </span><span class="n">item</span><span class="p">;</span>

<span class="w">        </span><span class="k">forever</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="n">data_item</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>
<span class="w">            </span><span class="n">meta_item</span><span class="w"> </span><span class="n">meta</span><span class="p">;</span>

<span class="w">            </span><span class="k">wait</span><span class="w"> </span><span class="p">(</span><span class="n">tmp_meta</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">tmp_data</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">            </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp_data</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span>
<span class="w">            </span><span class="n">meta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp_meta</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span>

<span class="w">            </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvm_common</span><span class="o">::</span><span class="n">model_item</span><span class="p">#(</span><span class="n">model_data</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">META_WIDTH</span><span class="p">))</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;item&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">            </span><span class="n">item</span><span class="p">.</span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model_data</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">META_WIDTH</span><span class="p">)</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;item.item&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">            </span><span class="n">item</span><span class="p">.</span><span class="n">item</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">.</span><span class="n">input_item</span><span class="p">;</span>
<span class="w">            </span><span class="n">item</span><span class="p">.</span><span class="n">item</span><span class="p">.</span><span class="n">meta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">meta</span><span class="p">.</span><span class="n">input_item</span><span class="p">;</span>
<span class="w">            </span><span class="n">item</span><span class="p">.</span><span class="n">tag</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;USER_TO_CORE&quot;</span><span class="p">;</span>
<span class="w">            </span><span class="n">item</span><span class="p">.</span><span class="n">start</span><span class="p">[{</span><span class="n">item</span><span class="p">.</span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="s">&quot; DATA&quot;</span><span class="p">}]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">.</span><span class="n">input_time</span><span class="p">;</span>
<span class="w">            </span><span class="n">item</span><span class="p">.</span><span class="n">start</span><span class="p">[{</span><span class="n">item</span><span class="p">.</span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="s">&quot; META&quot;</span><span class="p">}]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">meta</span><span class="p">.</span><span class="n">input_time</span><span class="p">;</span>

<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">endtask</span>
<span class="kd">endclass</span>
</pre></div>
</div>
</section>
<section id="id4">
<h3>Scoreboard<a class="headerlink" href="#id4" title="Link to this heading"></a></h3>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">comparer_meta</span><span class="w"> </span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">META_WIDTH</span><span class="p">)</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_common</span><span class="o">::</span><span class="n">comparer_base_tagged</span><span class="p">#(</span><span class="n">model_data</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">META_WIDTH</span><span class="p">),</span><span class="w"> </span><span class="n">uvm_logic_vector</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="n">META_WIDTH</span><span class="p">));</span>
<span class="w">    </span><span class="no">`uvm_component_param_utils</span><span class="p">(</span><span class="n">net_mod_logic_env</span><span class="o">::</span><span class="n">comparer_meta</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">META_WIDTH</span><span class="p">))</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">uvm_component</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">);</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">compare</span><span class="p">(</span><span class="n">MODEL_ITEM</span><span class="w"> </span><span class="n">tr_model</span><span class="p">,</span><span class="w"> </span><span class="n">DUT_ITEM</span><span class="w"> </span><span class="n">tr_dut</span><span class="p">);</span>
<span class="w">        </span><span class="c1">//return tr_model.meta.compare(tr_dut);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">tr_dut</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="mi">24</span><span class="o">-</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">tr_model</span><span class="p">.</span><span class="n">meta</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="mi">24</span><span class="o">-</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">]);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">message</span><span class="p">(</span><span class="n">MODEL_ITEM</span><span class="w"> </span><span class="n">tr_model</span><span class="p">,</span><span class="w"> </span><span class="n">DUT_ITEM</span><span class="w"> </span><span class="n">tr_dut</span><span class="p">);</span>
<span class="w">        </span><span class="kt">string</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="p">$</span><span class="n">swrite</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%s</span><span class="se">\n\t</span><span class="s">DUT PACKET %s</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w">   </span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="n">tr_dut</span><span class="p">.</span><span class="n">convert2string</span><span class="p">());</span>
<span class="w">        </span><span class="p">$</span><span class="n">swrite</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%s</span><span class="se">\n\t</span><span class="s">MODEL PACKET%s</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w">  </span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="n">tr_model</span><span class="p">.</span><span class="n">meta</span><span class="p">.</span><span class="n">convert2string</span><span class="p">());</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">msg</span><span class="p">;</span>
<span class="w">    </span><span class="k">endfunction</span>
<span class="kd">endclass</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">comparer_data</span><span class="w"> </span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">META_WIDTH</span><span class="p">)</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_common</span><span class="o">::</span><span class="n">comparer_base_tagged</span><span class="p">#(</span><span class="n">model_data</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">META_WIDTH</span><span class="p">),</span><span class="w"> </span><span class="n">uvm_logic_vector_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">));</span>
<span class="w">    </span><span class="no">`uvm_component_param_utils</span><span class="p">(</span><span class="n">net_mod_logic_env</span><span class="o">::</span><span class="n">comparer_data</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">META_WIDTH</span><span class="p">))</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">uvm_component</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">);</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">compare</span><span class="p">(</span><span class="n">MODEL_ITEM</span><span class="w"> </span><span class="n">tr_model</span><span class="p">,</span><span class="w"> </span><span class="n">DUT_ITEM</span><span class="w"> </span><span class="n">tr_dut</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">tr_model</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">compare</span><span class="p">(</span><span class="n">tr_dut</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">message</span><span class="p">(</span><span class="n">MODEL_ITEM</span><span class="w"> </span><span class="n">tr_model</span><span class="p">,</span><span class="w"> </span><span class="n">DUT_ITEM</span><span class="w"> </span><span class="n">tr_dut</span><span class="p">);</span>
<span class="w">        </span><span class="kt">string</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="p">$</span><span class="n">swrite</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%s</span><span class="se">\n\t</span><span class="s">DUT PACKET %s</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w">   </span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="n">tr_dut</span><span class="p">.</span><span class="n">convert2string</span><span class="p">());</span>
<span class="w">        </span><span class="p">$</span><span class="n">swrite</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%s</span><span class="se">\n\t</span><span class="s">MODEL PACKET%s</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w">  </span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="n">tr_model</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">convert2string</span><span class="p">());</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">msg</span><span class="p">;</span>
<span class="w">    </span><span class="k">endfunction</span>
<span class="kd">endclass</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">scoreboard</span><span class="w"> </span><span class="p">#(</span><span class="n">CHANNELS</span><span class="p">,</span><span class="w"> </span><span class="n">REGIONS</span><span class="p">,</span><span class="w"> </span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">META_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">HDR_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">RX_MAC_LITE_REGIONS</span><span class="p">)</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_scoreboard</span><span class="p">;</span>
<span class="w">    </span><span class="no">`uvm_component_param_utils</span><span class="p">(</span><span class="n">net_mod_logic_env</span><span class="o">::</span><span class="n">scoreboard</span><span class="w"> </span><span class="p">#(</span><span class="n">CHANNELS</span><span class="p">,</span><span class="w"> </span><span class="n">REGIONS</span><span class="p">,</span><span class="w"> </span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">META_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">HDR_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">RX_MAC_LITE_REGIONS</span><span class="p">))</span>

<span class="w">    </span><span class="c1">// TX path</span>
<span class="w">    </span><span class="n">uvm_analysis_export</span><span class="w"> </span><span class="p">#(</span><span class="n">uvm_logic_vector_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">))</span><span class="w">         </span><span class="n">tx_input_data</span><span class="p">;</span>
<span class="w">    </span><span class="n">uvm_analysis_export</span><span class="w"> </span><span class="p">#(</span><span class="n">uvm_logic_vector</span><span class="o">::</span><span class="n">sequence_item</span><span class="w"> </span><span class="p">#(</span><span class="n">META_WIDTH</span><span class="p">))</span><span class="w">              </span><span class="n">tx_input_meta</span><span class="p">;</span>

<span class="w">    </span><span class="n">uvm_analysis_export</span><span class="w"> </span><span class="p">#(</span><span class="n">uvm_logic_vector_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">))</span><span class="w">         </span><span class="n">tx_out</span><span class="p">[</span><span class="n">CHANNELS</span><span class="p">];</span>
<span class="w">    </span><span class="c1">//comparesrs</span>
<span class="w">    </span><span class="k">protected</span><span class="w"> </span><span class="n">uvm_common</span><span class="o">::</span><span class="n">comparer_ordered</span><span class="p">#(</span><span class="n">uvm_logic_vector_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">))</span><span class="w"> </span><span class="n">tx_compare</span><span class="p">[</span><span class="n">CHANNELS</span><span class="p">];</span>

<span class="w">    </span><span class="c1">// RX path</span>
<span class="w">    </span><span class="n">uvm_analysis_export</span><span class="w"> </span><span class="p">#(</span><span class="n">uvm_logic_vector_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">))</span><span class="w">        </span><span class="n">rx_input_data</span><span class="p">[</span><span class="n">CHANNELS</span><span class="p">];</span><span class="w"> </span><span class="c1">// data for model</span>

<span class="w">    </span><span class="n">uvm_analysis_export</span><span class="w"> </span><span class="p">#(</span><span class="n">uvm_logic_vector_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">))</span><span class="w">        </span><span class="n">rx_out_data</span><span class="p">;</span><span class="w"> </span><span class="c1">// MFB data from DUT</span>
<span class="w">    </span><span class="n">uvm_analysis_export</span><span class="w"> </span><span class="p">#(</span><span class="n">uvm_logic_vector</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="n">HDR_WIDTH</span><span class="p">))</span><span class="w">               </span><span class="n">rx_out_hdr</span><span class="p">;</span><span class="w"> </span><span class="c1">// MVB headers used to identify channel</span>

<span class="w">    </span><span class="c1">//comparers</span>
<span class="w">    </span><span class="c1">// Thing about comparer. Comparing have to be same as because output have to be tagged same.</span>
<span class="w">    </span><span class="k">protected</span><span class="w"> </span><span class="n">comparer_data</span><span class="w"> </span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">HDR_WIDTH</span><span class="p">)</span><span class="w"> </span><span class="n">rx_compare_data</span><span class="p">;</span>
<span class="w">    </span><span class="k">protected</span><span class="w"> </span><span class="n">comparer_meta</span><span class="w"> </span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">HDR_WIDTH</span><span class="p">)</span><span class="w"> </span><span class="n">rx_compare_meta</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// MVB discard</span>
<span class="w">    </span><span class="n">uvm_analysis_export</span><span class="w"> </span><span class="p">#(</span><span class="n">uvm_logic_vector</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="n">mvb_discard</span><span class="p">[</span><span class="n">CHANNELS</span><span class="p">];</span>
<span class="w">    </span><span class="k">protected</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="p">#(</span><span class="n">CHANNELS</span><span class="p">,</span><span class="w"> </span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">META_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">HDR_WIDTH</span><span class="p">)</span><span class="w"> </span><span class="n">m_model</span><span class="p">;</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">uvm_component</span><span class="w"> </span><span class="n">parent</span><span class="p">);</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// TX path</span>
<span class="w">        </span><span class="n">tx_input_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="s">&quot;tx_input_data&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">        </span><span class="n">tx_input_meta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="s">&quot;tx_input_meta&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// RX path</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">CHANNELS</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="kt">string</span><span class="w"> </span><span class="n">it_str</span><span class="p">;</span>
<span class="w">            </span><span class="n">it_str</span><span class="p">.</span><span class="n">itoa</span><span class="p">(</span><span class="n">it</span><span class="p">);</span>

<span class="w">            </span><span class="n">tx_out</span><span class="p">[</span><span class="n">it</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">({</span><span class="s">&quot;tx_out_&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">it_str</span><span class="p">},</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>

<span class="w">            </span><span class="n">rx_input_data</span><span class="p">[</span><span class="n">it</span><span class="p">]</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">({</span><span class="s">&quot;rx_input_data_&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">it_str</span><span class="p">},</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">            </span><span class="n">mvb_discard</span><span class="p">[</span><span class="n">it</span><span class="p">]</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">({</span><span class="s">&quot;mvb_discard_&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">it_str</span><span class="p">},</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">        </span><span class="n">rx_out_data</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="s">&quot;rx_out_data&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">        </span><span class="n">rx_out_hdr</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="s">&quot;rx_out_hdr&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">build_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>

<span class="w">        </span><span class="n">m_model</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="p">#(</span><span class="n">CHANNELS</span><span class="p">,</span><span class="w"> </span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">META_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">HDR_WIDTH</span><span class="p">)</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;m_model&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">        </span><span class="n">m_model</span><span class="p">.</span><span class="n">tx_input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model_input_fifo</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">META_WIDTH</span><span class="p">)</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;tx_input&quot;</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">m_model</span><span class="p">);</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">CHANNELS</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="kt">string</span><span class="w"> </span><span class="n">it_string</span><span class="p">;</span>
<span class="w">            </span><span class="n">it_string</span><span class="p">.</span><span class="n">itoa</span><span class="p">(</span><span class="n">it</span><span class="p">);</span>

<span class="w">            </span><span class="n">tx_compare</span><span class="p">[</span><span class="n">it</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvm_common</span><span class="o">::</span><span class="n">comparer_ordered</span><span class="p">#(</span><span class="n">uvm_logic_vector_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">))</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">({</span><span class="s">&quot;tx_compare_&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">it_string</span><span class="p">},</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>

<span class="w">            </span><span class="n">m_model</span><span class="p">.</span><span class="n">rx_input</span><span class="p">[</span><span class="n">it</span><span class="p">]</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">uvm_common</span><span class="o">::</span><span class="n">fifo_model_input</span><span class="p">#(</span><span class="n">uvm_logic_vector_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">))</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">({</span><span class="s">&quot;rx_input_data_&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">it_string</span><span class="p">}</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">m_model</span><span class="p">);</span>
<span class="w">            </span><span class="n">m_model</span><span class="p">.</span><span class="n">rx_discard</span><span class="p">[</span><span class="n">it</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uvm_common</span><span class="o">::</span><span class="n">fifo_model_input</span><span class="p">#(</span><span class="n">uvm_logic_vector</span><span class="o">::</span><span class="n">sequence_item</span><span class="w"> </span><span class="p">#(</span><span class="mi">1</span><span class="p">))</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">({</span><span class="s">&quot;rx_discard_&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">it_string</span><span class="p">}</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">m_model</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">        </span><span class="n">rx_compare_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comparer_data</span><span class="w"> </span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">HDR_WIDTH</span><span class="p">)</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;rx_compare_data&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">        </span><span class="n">rx_compare_meta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comparer_meta</span><span class="w"> </span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">HDR_WIDTH</span><span class="p">)</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;rx_compare_meta&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">connect_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>
<span class="w">        </span><span class="n">model_input_fifo</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">META_WIDTH</span><span class="p">)</span><span class="w"> </span><span class="n">tx_input</span><span class="p">;</span>
<span class="w">        </span><span class="n">uvm_common</span><span class="o">::</span><span class="n">fifo_model_input</span><span class="p">#(</span><span class="n">uvm_logic_vector_array</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">#(</span><span class="n">ITEM_WIDTH</span><span class="p">))</span><span class="w"> </span><span class="n">rx_input</span><span class="p">;</span>
<span class="w">        </span><span class="n">uvm_common</span><span class="o">::</span><span class="n">fifo_model_input</span><span class="p">#(</span><span class="n">uvm_logic_vector</span><span class="o">::</span><span class="n">sequence_item</span><span class="w"> </span><span class="p">#(</span><span class="mi">1</span><span class="p">))</span><span class="w">               </span><span class="n">rx_discard</span><span class="p">;</span>

<span class="w">        </span><span class="c1">//TX INPUT</span>
<span class="w">        </span><span class="p">$</span><span class="n">cast</span><span class="p">(</span><span class="n">tx_input</span><span class="p">,</span><span class="w"> </span><span class="n">m_model</span><span class="p">.</span><span class="n">tx_input</span><span class="p">);</span>
<span class="w">        </span><span class="n">tx_input_data</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">tx_input</span><span class="p">.</span><span class="n">analysis_export_data</span><span class="p">);</span>
<span class="w">        </span><span class="n">tx_input_meta</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">tx_input</span><span class="p">.</span><span class="n">analysis_export_meta</span><span class="p">);</span>
<span class="w">        </span><span class="c1">//RX INPUT</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">CHANNELS</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="n">m_model</span><span class="p">.</span><span class="n">tx_output</span><span class="p">[</span><span class="n">it</span><span class="p">].</span><span class="n">connect</span><span class="p">(</span><span class="n">tx_compare</span><span class="p">[</span><span class="n">it</span><span class="p">].</span><span class="n">analysis_imp_model</span><span class="p">);</span>
<span class="w">            </span><span class="n">tx_out</span><span class="p">[</span><span class="n">it</span><span class="p">].</span><span class="n">connect</span><span class="p">(</span><span class="n">tx_compare</span><span class="p">[</span><span class="n">it</span><span class="p">].</span><span class="n">analysis_imp_dut</span><span class="p">);</span>

<span class="w">            </span><span class="p">$</span><span class="n">cast</span><span class="p">(</span><span class="n">rx_input</span><span class="p">,</span><span class="w"> </span><span class="n">m_model</span><span class="p">.</span><span class="n">rx_input</span><span class="p">[</span><span class="n">it</span><span class="p">]);</span>
<span class="w">            </span><span class="n">rx_input_data</span><span class="p">[</span><span class="n">it</span><span class="p">].</span><span class="n">connect</span><span class="p">(</span><span class="n">rx_input</span><span class="p">.</span><span class="n">analysis_export</span><span class="p">);</span>
<span class="w">            </span><span class="p">$</span><span class="n">cast</span><span class="p">(</span><span class="n">rx_discard</span><span class="p">,</span><span class="w"> </span><span class="n">m_model</span><span class="p">.</span><span class="n">rx_discard</span><span class="p">[</span><span class="n">it</span><span class="p">]);</span>
<span class="w">            </span><span class="n">mvb_discard</span><span class="p">[</span><span class="n">it</span><span class="p">].</span><span class="n">connect</span><span class="p">(</span><span class="n">rx_discard</span><span class="p">.</span><span class="n">analysis_export</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">        </span><span class="n">m_model</span><span class="p">.</span><span class="n">rx_output</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">rx_compare_data</span><span class="p">.</span><span class="n">analysis_imp_model</span><span class="p">);</span>
<span class="w">        </span><span class="n">m_model</span><span class="p">.</span><span class="n">rx_output</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">rx_compare_meta</span><span class="p">.</span><span class="n">analysis_imp_model</span><span class="p">);</span>
<span class="w">        </span><span class="n">rx_out_data</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">rx_compare_data</span><span class="p">.</span><span class="n">analysis_imp_dut</span><span class="p">);</span>
<span class="w">        </span><span class="n">rx_out_hdr</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">rx_compare_meta</span><span class="p">.</span><span class="n">analysis_imp_dut</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">used</span><span class="p">();</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">m_model</span><span class="p">.</span><span class="n">used</span><span class="p">();</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">CHANNELS</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="n">ret</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">tx_compare</span><span class="p">[</span><span class="n">it</span><span class="p">].</span><span class="n">used</span><span class="p">();</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">rx_compare_data</span><span class="p">.</span><span class="n">used</span><span class="p">();</span>
<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">rx_compare_meta</span><span class="p">.</span><span class="n">used</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">success</span><span class="p">();</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">CHANNELS</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="n">ret</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="n">tx_compare</span><span class="p">[</span><span class="n">it</span><span class="p">].</span><span class="n">success</span><span class="p">();</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="n">rx_compare_data</span><span class="p">.</span><span class="n">success</span><span class="p">();</span>
<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="n">rx_compare_meta</span><span class="p">.</span><span class="n">success</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">report_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">total_errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="kt">string</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// TX path</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">CHANNELS</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="p">$</span><span class="n">swrite</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%s</span><span class="se">\n\t</span><span class="s">TX path OUTPUT [%0d]: %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="p">,</span><span class="w"> </span><span class="n">tx_compare</span><span class="p">[</span><span class="n">it</span><span class="p">].</span><span class="n">info</span><span class="p">());</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">        </span><span class="p">$</span><span class="n">swrite</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%s</span><span class="se">\n\t</span><span class="s">---------------------------------------&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">);</span>
<span class="w">        </span><span class="p">$</span><span class="n">swrite</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%s</span><span class="se">\n\t</span><span class="s">RX path OUTPUT DATA : %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">,</span><span class="w">  </span><span class="n">rx_compare_data</span><span class="p">.</span><span class="n">info</span><span class="p">());</span>
<span class="w">        </span><span class="p">$</span><span class="n">swrite</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%s</span><span class="se">\n\t</span><span class="s">RX path OUTPUT META : %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">,</span><span class="w">  </span><span class="n">rx_compare_meta</span><span class="p">.</span><span class="n">info</span><span class="p">());</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">success</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">used</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="no">`uvm_info</span><span class="p">(</span><span class="n">get_type_name</span><span class="p">(),</span><span class="w"> </span><span class="p">{</span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n\n\t</span><span class="s">---------------------------------------</span><span class="se">\n\t</span><span class="s">----     VERIFICATION SUCCESS      ----</span><span class="se">\n\t</span><span class="s">---------------------------------------&quot;</span><span class="p">},</span><span class="w"> </span><span class="n">UVM_NONE</span><span class="p">)</span>
<span class="w">        </span><span class="k">end</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="no">`uvm_info</span><span class="p">(</span><span class="n">get_type_name</span><span class="p">(),</span><span class="w"> </span><span class="p">{</span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n\n\t</span><span class="s">---------------------------------------</span><span class="se">\n\t</span><span class="s">----     VERIFICATION FAIL      ----</span><span class="se">\n\t</span><span class="s">---------------------------------------&quot;</span><span class="p">},</span><span class="w"> </span><span class="n">UVM_NONE</span><span class="p">)</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="kd">endclass</span>
</pre></div>
</div>
</section>
<section id="test-environment">
<h3>Test environment<a class="headerlink" href="#test-environment" title="Link to this heading"></a></h3>
<p>After creating the model and the scoreboard, we can assemble a test environment
<em>env</em>. We use the <em>byte_array_port</em> environment, which we have created earlier,
and the <em>byte_array_mfb</em> environment, which is located in the OFM repository in
the directory <em>comp/uvm/byte_array_mfb</em>. It is required to specify the path in
the <em>Modules.tcl</em> file.</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">env</span><span class="p">#(</span><span class="n">PORTS</span><span class="p">,</span><span class="w"> </span><span class="n">REGIONS</span><span class="p">)</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_env</span><span class="p">;</span>
<span class="w">    </span><span class="no">`uvm_component_param_utils</span><span class="p">(</span><span class="n">packet_splitter</span><span class="o">::</span><span class="n">env</span><span class="p">#(</span><span class="n">PORTS</span><span class="p">,</span><span class="w"> </span><span class="n">REGIONS</span><span class="p">))</span>

<span class="w">    </span><span class="c1">//rx agents</span>
<span class="w">    </span><span class="n">byte_array_port_env</span><span class="o">::</span><span class="n">env</span><span class="w">                </span><span class="n">rx_env</span><span class="p">;</span>

<span class="w">    </span><span class="c1">//tx agent</span>
<span class="w">    </span><span class="n">byte_aray_mfb</span><span class="o">::</span><span class="n">tx_env_base</span><span class="p">#(</span><span class="n">REGIONS</span><span class="p">)</span><span class="w">    </span><span class="n">tx_env</span><span class="p">[</span><span class="n">PORTS</span><span class="p">];</span>

<span class="w">    </span><span class="c1">//scoreboard</span>
<span class="w">    </span><span class="n">scoreboard</span><span class="p">#(</span><span class="n">PORTS</span><span class="p">,</span><span class="w"> </span><span class="n">REGIONS</span><span class="p">)</span><span class="w">             </span><span class="n">sc</span><span class="p">;</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">uvm_component</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">);</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">build_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>

<span class="w">        </span><span class="n">rx_env</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">byte_array_port_env</span><span class="o">::</span><span class="n">env</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;rx_env&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">PORTS</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="kt">string</span><span class="w"> </span><span class="n">it_num</span><span class="p">;</span>
<span class="w">            </span><span class="n">it_num</span><span class="p">.</span><span class="n">itoa</span><span class="p">(</span><span class="n">it</span><span class="p">);</span>
<span class="w">            </span><span class="n">tx_env</span><span class="p">[</span><span class="n">it</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">byte_aray_mfb</span><span class="o">::</span><span class="n">tx_env_base</span><span class="p">#(</span><span class="n">REGIONS</span><span class="p">)</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">({</span><span class="s">&quot;tx_env_&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">it_num</span><span class="p">},</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">        </span><span class="n">sc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scoreboard</span><span class="p">#(</span><span class="n">PORTS</span><span class="p">,</span><span class="w"> </span><span class="n">REGIONS</span><span class="p">)</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;sc&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>

<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">connect_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>

<span class="w">        </span><span class="n">rx_env</span><span class="p">.</span><span class="n">analysis_port</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">sc</span><span class="p">.</span><span class="n">analysis_export_rx_packet</span><span class="p">);</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">PORTS</span><span class="p">;</span><span class="w"> </span><span class="n">it</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="n">tx_env</span><span class="p">[</span><span class="n">it</span><span class="p">].</span><span class="n">m_byte_array</span><span class="p">.</span><span class="n">analysis_port</span><span class="p">(</span><span class="n">sc</span><span class="p">.</span><span class="n">analysis_export_tx_packet</span><span class="p">[</span><span class="n">it</span><span class="p">]);</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">    </span><span class="k">endfunction</span>

<span class="kd">endclass</span>
</pre></div>
</div>
</section>
<section id="test">
<h3>Test<a class="headerlink" href="#test" title="Link to this heading"></a></h3>
<p>The test runs the highest level sequence and creates specific adjustments to the
verification environment. For some tests, we want to generate a full-speed
traffic for the MFB without any inter-frame gaps or gaps between the frames.
These adjustments are added by the UVM abstract factory. For more information,
see the <em>sequence library</em> section on this page.</p>
<p>An example of the full speed MFB sequence:</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">sequence_rx_rdy</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_sequence</span><span class="p">(</span><span class="n">mfb</span><span class="o">::</span><span class="n">sequence_item</span><span class="p">)</span>
<span class="w">    </span><span class="no">`uvm_object_utils</span><span class="p">(</span><span class="n">test</span><span class="o">::</span><span class="n">sequence_rx_rdy</span><span class="p">)</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">task</span><span class="w"> </span><span class="n">body</span><span class="p">();</span>

<span class="w">        </span><span class="n">req</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mfb</span><span class="o">::</span><span class="n">sequence_item</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">();</span>

<span class="w">        </span><span class="k">forever</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="no">`uvm_do_with</span><span class="w"> </span><span class="p">(</span><span class="n">req</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">rdy</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">});</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">    </span><span class="k">endtask</span>

<span class="kd">endclass</span>
</pre></div>
</div>
<p>An example of the Test:</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">base</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_test</span>
<span class="w">    </span><span class="no">`uvm_component_utils</span><span class="p">(</span><span class="n">test</span><span class="o">::</span><span class="n">base</span><span class="p">)</span>

<span class="w">    </span><span class="n">packet_splitter</span><span class="o">::</span><span class="n">env_main</span><span class="p">#(</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">m_env</span><span class="p">;</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="k">new</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">uvm_component</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">null</span><span class="p">);</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">function</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">build_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>
<span class="w">        </span><span class="n">m_env</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">packet_splitter</span><span class="o">::</span><span class="n">env_main</span><span class="p">#(</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">::</span><span class="n">type_id</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;m_env&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
<span class="w">    </span><span class="k">endfunction</span>

<span class="w">    </span><span class="k">task</span><span class="w"> </span><span class="n">run_phase</span><span class="p">(</span><span class="n">uvm_phase</span><span class="w"> </span><span class="n">phase</span><span class="p">);</span>

<span class="w">         </span><span class="n">test</span><span class="o">::</span><span class="n">sequence_rx</span><span class="w">     </span><span class="n">seq_rx_packet</span><span class="p">;</span>
<span class="w">         </span><span class="n">test</span><span class="o">::</span><span class="n">sequence_tx_rdy</span><span class="w"> </span><span class="n">seq_tx_rdy</span><span class="p">;</span>

<span class="w">         </span><span class="n">phase</span><span class="p">.</span><span class="n">raise_objection</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

<span class="w">         </span><span class="k">fork</span>
<span class="w">            </span><span class="no">`uvm_do</span><span class="p">(</span><span class="n">seq_rx_packet</span><span class="p">,</span><span class="w"> </span><span class="n">m_env</span><span class="p">.</span><span class="n">rx_env</span><span class="p">.</span><span class="n">m_sequencer</span><span class="p">);</span>
<span class="w">            </span><span class="no">`uvm_do</span><span class="p">(</span><span class="n">seq_tx_rdy</span><span class="p">,</span><span class="w">    </span><span class="n">m_env</span><span class="p">.</span><span class="n">tx_env</span><span class="p">.</span><span class="n">m_sequencer</span><span class="p">);</span>
<span class="w">         </span><span class="k">join_any</span>

<span class="w">         </span><span class="n">phase</span><span class="p">.</span><span class="n">drop_objection</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

<span class="w">    </span><span class="k">endtask</span>

<span class="kd">endclass</span>
</pre></div>
</div>
</section>
<section id="id5">
<h3>Properties<a class="headerlink" href="#id5" title="Link to this heading"></a></h3>
<p>Properties contain interfacing protocol rules to which the DUT must adhere
as well as other DUT properties.</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="k">module</span><span class="w"> </span><span class="n">mfb_splitter_properties</span><span class="w"> </span><span class="p">#(</span><span class="n">OUTPUTS</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">logic</span><span class="w"> </span><span class="n">CLK</span><span class="p">,</span><span class="w"> </span><span class="n">reset_if</span><span class="w"> </span><span class="n">RESET</span><span class="p">,</span><span class="w"> </span><span class="n">mfb_if</span><span class="w"> </span><span class="n">RX_MFB</span><span class="p">,</span><span class="w"> </span><span class="n">mvb_if</span><span class="w"> </span><span class="n">RX_MFB</span><span class="p">,</span><span class="w"> </span><span class="n">mfb_if</span><span class="w"> </span><span class="n">TX_MFB</span><span class="p">[</span><span class="n">OUTPUTS</span><span class="p">]);</span>

<span class="w">    </span><span class="n">mfb_properties</span><span class="w"> </span><span class="p">(</span>
<span class="w">         </span><span class="p">.</span><span class="n">CLK</span><span class="w">   </span><span class="p">(</span><span class="n">CLK</span><span class="p">),</span>
<span class="w">         </span><span class="p">.</span><span class="n">RESET</span><span class="w"> </span><span class="p">(</span><span class="n">RESET</span><span class="p">),</span>
<span class="w">         </span><span class="p">.</span><span class="n">MFB</span><span class="w">   </span><span class="p">(</span><span class="n">RX_MFB</span><span class="p">)</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">    </span><span class="n">mvb_properties</span><span class="w"> </span><span class="p">(</span>
<span class="w">         </span><span class="p">.</span><span class="n">CLK</span><span class="w">   </span><span class="p">(</span><span class="n">CLK</span><span class="p">),</span>
<span class="w">         </span><span class="p">.</span><span class="n">RESET</span><span class="w"> </span><span class="p">(</span><span class="n">RESET</span><span class="p">),</span>
<span class="w">         </span><span class="p">.</span><span class="n">MVB</span><span class="w">   </span><span class="p">(</span><span class="n">RX_MVB</span><span class="p">)</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="c1">// you can add more properties if you want.</span>

<span class="k">endmodule</span>
</pre></div>
</div>
</section>
<section id="testbench">
<h3>Testbench<a class="headerlink" href="#testbench" title="Link to this heading"></a></h3>
<p>It is required to put the <em>$stop()</em> command after the <em>run_test</em> command. If you
do not want to quit ModelSim after <em>drop_objection</em>, you must set the
<em>finish_on_completion</em> variable to zero. If you set the variable
<em>finish_on_completion</em> to zero, the verification might not stop. This problem
can be fixed by putting the <em>$stop()</em> command after <em>run_test()</em> command. For
example, you must set the <em>finish_on_completion</em> variable to zero if you wish to
generate coverage.</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="k">module</span><span class="w"> </span><span class="n">testbench</span><span class="w"> </span><span class="p">#(</span><span class="n">OUTPUTS</span><span class="p">);</span>

<span class="w">    </span><span class="kt">logic</span><span class="w"> </span><span class="n">CLK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="n">reset_if</span><span class="w">                                               </span><span class="n">rst</span><span class="p">(</span><span class="n">CLK</span><span class="p">);</span>
<span class="w">    </span><span class="n">mvb_if</span><span class="w"> </span><span class="p">#(</span><span class="n">REGIONS</span><span class="p">,</span><span class="w"> </span><span class="n">MVB_ITEM_WIDTH</span><span class="p">)</span><span class="w">                      </span><span class="n">rx_mvb</span><span class="p">(</span><span class="n">CLK</span><span class="p">);</span>
<span class="w">    </span><span class="n">mfb_if</span><span class="w"> </span><span class="p">#(</span><span class="n">REGIONS</span><span class="p">,</span><span class="w"> </span><span class="n">REGION_SIZE</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_SIZE</span><span class="p">,</span><span class="w"> </span><span class="n">ITEM_WIDTH</span><span class="p">)</span><span class="w"> </span><span class="n">rx_mfb</span><span class="p">(</span><span class="n">CLK</span><span class="p">);</span>
<span class="w">    </span><span class="n">mfb_if</span><span class="w"> </span><span class="p">#(</span><span class="n">REGIONS</span><span class="p">,</span><span class="w"> </span><span class="n">REGION_SIZE</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_SIZE</span><span class="p">,</span><span class="w"> </span><span class="n">ITEM_WIDTH</span><span class="p">)</span><span class="w"> </span><span class="n">tx_mfb</span><span class="p">[</span><span class="n">OUTPUTS</span><span class="p">](</span><span class="n">CLK</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// create clock</span>
<span class="w">    </span><span class="k">always</span><span class="w"> </span><span class="p">#(</span><span class="n">CLK_PERIOD</span><span class="p">)</span><span class="w"> </span><span class="n">CLK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">CLK</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Start of tests</span>
<span class="w">    </span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>

<span class="w">        </span><span class="n">uvm_root</span><span class="w"> </span><span class="n">m_root</span><span class="p">;</span>
<span class="w">        </span><span class="k">virtual</span><span class="w"> </span><span class="n">mfb_if</span><span class="w"> </span><span class="p">#(</span><span class="n">REGIONS</span><span class="p">,</span><span class="w"> </span><span class="n">REGION_SIZE</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_SIZE</span><span class="p">,</span><span class="w"> </span><span class="n">ITEM_WIDTH</span><span class="p">)</span><span class="w"> </span><span class="n">v_tx_mfb</span><span class="p">;</span>

<span class="w">        </span><span class="n">v_tx_mfb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tx_mfb</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Configuration TX</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">OUTPUTS</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="kt">string</span><span class="w"> </span><span class="n">i_string</span><span class="p">;</span>
<span class="w">            </span><span class="n">i_string</span><span class="p">.</span><span class="n">itoa</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="w">            </span><span class="n">uvm_config_db</span><span class="p">#(</span><span class="k">virtual</span><span class="w"> </span><span class="n">mfb_if</span><span class="w"> </span><span class="p">#(</span><span class="n">REGIONS</span><span class="p">,</span><span class="w"> </span><span class="n">REGION_SIZE</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_SIZE</span><span class="p">,</span><span class="w"> </span><span class="n">ITEM_WIDTH</span><span class="p">))</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;OUTPUT_MFB_&quot;</span><span class="p">,</span><span class="n">i_string</span><span class="p">},</span><span class="w"> </span><span class="n">v_mfb_tx</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">        </span><span class="c1">// save pointer to interface into configuration database</span>
<span class="w">        </span><span class="n">uvm_config_db</span><span class="p">#(</span><span class="k">virtual</span><span class="w"> </span><span class="n">mfb_if</span><span class="w"> </span><span class="p">#(</span><span class="n">REGIONS</span><span class="p">,</span><span class="w"> </span><span class="n">REGION_SIZE</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_SIZE</span><span class="p">,</span><span class="w"> </span><span class="n">ITEM_WIDTH</span><span class="p">))</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;INPUT_MFB&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">rx_mfb</span><span class="p">);</span>
<span class="w">        </span><span class="n">uvm_config_db</span><span class="p">#(</span><span class="k">virtual</span><span class="w"> </span><span class="n">mvb_if</span><span class="w"> </span><span class="p">#(</span><span class="n">REGIONS</span><span class="p">,</span><span class="w"> </span><span class="n">MVB_ITEM_WIDTH</span><span class="p">))</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;INPUT_MVB&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">rx_mfb</span><span class="p">);</span>
<span class="w">        </span><span class="n">uvm_config_db</span><span class="p">#(</span><span class="k">virtual</span><span class="w"> </span><span class="n">reset_if</span><span class="p">)</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;RESET&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">rst</span><span class="p">);</span>

<span class="w">        </span><span class="n">m_root</span><span class="w">                          </span><span class="o">=</span><span class="w"> </span><span class="n">uvm_root</span><span class="o">::</span><span class="n">get</span><span class="p">();</span><span class="w">           </span><span class="c1">//get root component</span>
<span class="w">        </span><span class="n">m_root</span><span class="p">.</span><span class="n">finish_on_completion</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">    </span><span class="c1">//now finish on end. required stop command after run_test</span>
<span class="w">        </span><span class="c1">//stop reporting ILLEGALNAME when sequence in sequence library have been started</span>
<span class="w">        </span><span class="n">m_root</span><span class="p">.</span><span class="n">set_report_id_action_tier</span><span class="p">(</span><span class="s">&quot;ILLEGALNAME&quot;</span><span class="p">,</span><span class="n">UVM_NO_ACTION</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Stop reporting for us unusefull information</span>
<span class="w">        </span><span class="n">uvm_config_db</span><span class="p">#(</span><span class="kt">int</span><span class="p">)</span><span class="w">            </span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;recording_detail&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="n">uvm_config_db</span><span class="p">#(</span><span class="n">uvm_bitstream_t</span><span class="p">)</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;recording_detail&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>

<span class="w">        </span><span class="n">run_test</span><span class="p">();</span>
<span class="w">        </span><span class="p">$</span><span class="n">stop</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="c1">// DUT module</span>
<span class="w">    </span><span class="n">DUT</span><span class="w"> </span><span class="p">#(</span><span class="n">OUTPUTS</span><span class="p">)</span><span class="w"> </span><span class="n">DUT_U</span><span class="w"> </span><span class="p">(</span>
<span class="w">      </span><span class="p">.</span><span class="n">CLK</span><span class="w">    </span><span class="p">(</span><span class="n">CLK</span><span class="p">),</span>
<span class="w">      </span><span class="p">.</span><span class="n">RESET</span><span class="w">  </span><span class="p">(</span><span class="n">rst</span><span class="p">),</span>
<span class="w">      </span><span class="p">.</span><span class="n">RX_MFB</span><span class="w"> </span><span class="p">(</span><span class="n">rx_mfb</span><span class="p">),</span>
<span class="w">      </span><span class="p">.</span><span class="n">RX_MVB</span><span class="w"> </span><span class="p">(</span><span class="n">rx_mvb</span><span class="p">),</span>
<span class="w">      </span><span class="p">.</span><span class="n">TX_MFB</span><span class="w"> </span><span class="p">(</span><span class="n">mfb</span><span class="p">)</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="c1">// check of properties</span>
<span class="w">    </span><span class="n">MFB_SPLITTER_PROPERTIES</span><span class="w"> </span><span class="p">#(</span><span class="n">OUTPUTS</span><span class="p">)</span><span class="w"> </span><span class="n">PRT</span><span class="w"> </span><span class="p">(</span>
<span class="w">      </span><span class="p">.</span><span class="n">CLK</span><span class="w">   </span><span class="p">(</span><span class="n">CLK</span><span class="p">),</span>
<span class="w">      </span><span class="p">.</span><span class="n">RESET</span><span class="w">  </span><span class="p">(</span><span class="n">rst</span><span class="p">),</span>
<span class="w">      </span><span class="p">.</span><span class="n">RX_MFB</span><span class="w"> </span><span class="p">(</span><span class="n">rx_mfb</span><span class="p">),</span>
<span class="w">      </span><span class="p">.</span><span class="n">RX_MVB</span><span class="w"> </span><span class="p">(</span><span class="n">rx_mvb</span><span class="p">),</span>
<span class="w">      </span><span class="p">.</span><span class="n">TX_MFB</span><span class="w"> </span><span class="p">(</span><span class="n">mfb</span><span class="p">)</span>
<span class="w">    </span><span class="p">);</span>

<span class="k">endmodule</span>
</pre></div>
</div>
</section>
</section>
<section id="notes">
<h2>NOTES<a class="headerlink" href="#notes" title="Link to this heading"></a></h2>
<section id="uvm-info">
<h3>UVM_info<a class="headerlink" href="#uvm-info" title="Link to this heading"></a></h3>
<p>Please use this macro to print information about the verification. The following table
lists the available log levels in the UVM and the specific information they provide</p>
<table class="docutils align-default" id="id6">
<caption><span class="caption-text">uvm_info</span><a class="headerlink" href="#id6" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 2.4%" />
<col style="width: 97.6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>uvm_info level</p></th>
<th class="head"><p>What information is printed</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>UVM_NONE</p></td>
<td><p>Statistics and verification results at the end of the verification</p></td>
</tr>
<tr class="row-odd"><td><p>UVM_LOW</p></td>
<td><p>Statistics during the verification run.</p></td>
</tr>
<tr class="row-even"><td><p>UVM_MEDIUM</p></td>
<td><p>The model’s configuration, if it is configured.</p></td>
</tr>
<tr class="row-odd"><td><p>UVM_HIGH</p></td>
<td><p>Model output transactions.</p></td>
</tr>
<tr class="row-even"><td><p>UVM_FULL</p></td>
<td><p>Model output transactions + all data from which the output transaction is calculated (for example, hash algorithm)</p></td>
</tr>
<tr class="row-odd"><td><p>UVM_DEBUG</p></td>
<td><p>The sequence name when the sequence is started and other debug information.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="uvm-error-vs-uvm-fatal">
<h3>UVM_error vs UVM_fatal<a class="headerlink" href="#uvm-error-vs-uvm-fatal" title="Link to this heading"></a></h3>
<p>The difference between the <em>UVM_error</em> and the <em>UVM_fatal</em> macros is in the
meaning. The <em>UVM_fatal</em> macro represents an error in the verification
environment. For example, when an agent cannot find an interface. The
<em>UVM_error</em> macro should be used for reporting errors in the DUT, for example,
when the output transaction does not match the expected transaction.</p>
<p>For better readability of the messages written by the macros, follow these rules:</p>
<ol class="arabic simple">
<li><p>Put the newline and the tabulator character at the beginning of each string
<em>“\n\ttext”</em></p></li>
<li><p>It is required to put more tabulator characters (\t) after a newline
depending of the indentation.</p></li>
<li><p>Do not write the newline character (\n) at the end of a text. The UVM macros
automatically add it to the end of the string.</p></li>
</ol>
</section>
<section id="parametrized-object">
<h3>Parametrized object<a class="headerlink" href="#parametrized-object" title="Link to this heading"></a></h3>
<p>If you need a parametrized <em>uvm_object</em> or <em>uvm_component</em>, use registration
macros <em>uvm_component_param_utils</em> and <em>uvm_object_param_utils</em>. Parametrized
object can be required when an interface uses a signal with parametrized width.</p>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">non_parametrized_class</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_object</span><span class="p">;</span>
<span class="w">    </span><span class="no">`uvm_object_utils</span><span class="p">#(</span><span class="n">pkg</span><span class="o">::</span><span class="n">non_parametrized_class</span><span class="p">);</span>

<span class="w">     </span><span class="p">...</span>

<span class="kd">endclass</span>
</pre></div>
</div>
<div class="highlight-systemverilog notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nc">parametrized_class</span><span class="p">#(</span><span class="n">PARAM</span><span class="p">)</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="nc">uvm_object</span><span class="p">;</span>
<span class="w">    </span><span class="no">`uvm_object_param_utils</span><span class="p">#(</span><span class="n">pkg</span><span class="o">::</span><span class="n">non_parametrized_class</span><span class="p">#(</span><span class="n">PARAM</span><span class="p">));</span>

<span class="w">    </span><span class="kt">logic</span><span class="w"> </span><span class="p">[</span><span class="n">PARAM</span><span class="o">-</span><span class="mi">1</span><span class="o">:</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="n">val</span><span class="p">;</span>

<span class="w">     </span><span class="p">...</span>

<span class="kd">endclass</span>
</pre></div>
</div>
</section>
<section id="synchronization">
<h3>Synchronization<a class="headerlink" href="#synchronization" title="Link to this heading"></a></h3>
<p>The UVM provides the <em>uvm_event</em> class to achieve synchronization. This class
offers even more functionalities, such as the standard barrier in SystemVerilog.
There is also the <em>uvm_pool</em>, which provides access to the <em>uvm_barrier</em> using a
name.</p>
</section>
</section>
<section id="ofm-verification-environment">
<h2>OFM verification environment<a class="headerlink" href="#ofm-verification-environment" title="Link to this heading"></a></h2>
<p>When you need to create a new agent, you can get inspiration from: <a class="reference external" href="https://gitlab.liberouter.org/ndk/ofm/-/tree/devel/comp/uvm/mfb">MVB agent</a>. You should
place all classes related to one agent or an environment into one directory. A
package (pkg.sv) includes all files in that directory. It should also contain an
existing Modules.tcl file which includes pkg.sv, interface.sv (if required), and
all other required packages. If the interface is bidirectional, then all files
with the <em>uvm_component</em> should contain two classes: <em>agent_rx</em> and <em>agent_tx</em>.
See the MI interface as an example for the bidirectional and the pipelined
interface. Also, the slave side has to be able to respond in the same clock
cycle as a request occurs (this is not implemented).</p>
<img alt="interface direction" class="align-center" src="../../_images/interface_direction.svg" />
<section id="modules-tcl">
<h3>Modules.tcl<a class="headerlink" href="#modules-tcl" title="Link to this heading"></a></h3>
<p>Written in TCL language, this file contains the required components and
dependencies for the package. The following command adds a package that will be
compiled first. One of the commonly used packages is <em>math_pkg.sv</em> which
contains common mathematical functions.</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="nb">lappend</span><span class="w"> </span>PACKAGES<span class="w"> </span><span class="s2">&quot;$ENTITY_BASE/math_pack.vhd&quot;</span>
</pre></div>
</div>
<p>The following command adds two required components <em>SH_REG</em> and <em>FIFOX</em>. The
<em>SH_REG</em> component is located in the <em>$OFM_PATH/comp/base/shreg/sh_reg_base</em>
directory. The last parameter specifies the architecture to be loaded: <em>FULL</em>.</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="nb">lappend</span><span class="w"> </span>COMPONENTS<span class="w"> </span><span class="k">[</span><span class="w"> </span><span class="nb">list</span><span class="w"> </span><span class="s2">&quot;SH_REG&quot;</span><span class="w">      </span><span class="nv">$OFM_PATH</span><span class="o">/</span>comp<span class="o">/</span>base<span class="o">/</span>shreg<span class="o">/</span>sh_reg_base<span class="w">       </span><span class="s2">&quot;FULL&quot;</span><span class="w"> </span><span class="k">]</span>
<span class="nb">lappend</span><span class="w"> </span>COMPONENTS<span class="w"> </span><span class="k">[</span><span class="w"> </span><span class="nb">list</span><span class="w"> </span><span class="s2">&quot;FIFOX&quot;</span><span class="w">       </span><span class="nv">$OFM_PATH</span><span class="o">/</span>comp<span class="o">/</span>base<span class="o">/</span>fifo<span class="o">/</span>fifox<span class="w">              </span><span class="s2">&quot;FULL&quot;</span><span class="w"> </span><span class="k">]</span>
</pre></div>
</div>
<p>Whenever a VHLD design consists of two files (<em>arch.vhd</em> and <em>ent.vhd</em>), load them both with the
following commands:</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="nb">lappend</span><span class="w"> </span>MOD<span class="w"> </span><span class="s2">&quot;$ENTITY_BASE/arch.vhd&quot;</span>
<span class="nb">lappend</span><span class="w"> </span>MOD<span class="w"> </span><span class="s2">&quot;$ENTITY_BASE/ent.vhd&quot;</span>
</pre></div>
</div>
</section>
<section id="main-fdo-script-for-running-the-verification">
<h3>Main .fdo script for running the verification<a class="headerlink" href="#main-fdo-script-for-running-the-verification" title="Link to this heading"></a></h3>
<p>This file is typically named <em>top_level.fdo</em> and contains the <em>COMPONENT</em>
variable which typically holds two items:</p>
<ol class="arabic simple">
<li><p>the verified design (DUT)</p></li>
<li><p>the verification environment.</p></li>
</ol>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="nb">lappend</span><span class="w"> </span>COMPONENTS<span class="w"> </span><span class="k">[</span><span class="nb">list</span><span class="w"> </span><span class="s2">&quot;DUT&quot;</span><span class="w">  </span><span class="nv">$DUT_BASE</span><span class="w">  </span><span class="s2">&quot;FULL&quot;</span><span class="k">]</span>
<span class="nb">lappend</span><span class="w"> </span>COMPONENTS<span class="w"> </span><span class="k">[</span><span class="nb">list</span><span class="w"> </span><span class="s2">&quot;VER&quot;</span><span class="w">  </span><span class="nv">$VER_BASE</span><span class="w">  </span><span class="s2">&quot;FULL&quot;</span><span class="k">]</span>
</pre></div>
</div>
<p>You can suppress warnings printed by the <em>numeric_std</em> or the <em>std_logic_arith</em>
library.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The usage of the std_logic_arith (as well as other non-standard libraries) is discouraged.</p>
</div>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="c">#Suppress warnings from the numeric_std library</span>
<span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Numeric Std Warnings - Disabled&quot;</span>
<span class="k">set</span><span class="w"> </span>NumericStdNoWarnings<span class="w"> </span><span class="mi">1</span>

<span class="c">#Suppress warnings from the std_arith library</span>
<span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Std Arith Warnings - Disabled&quot;</span>
<span class="k">set</span><span class="w"> </span>StdArithNoWarnings<span class="w"> </span><span class="mi">1</span>
</pre></div>
</div>
<p>The following command adds some extra parameter to the vsim. Last parameter
<em>+UVM_MAX_QUIT_COUNT=X</em> stops the verification after <em>X</em> <em>UVM_errors</em> occur.</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="k">set</span><span class="w"> </span>SIM_FLAGS<span class="k">(</span><span class="nv">EXTRA_VFLAGS</span><span class="k">)</span><span class="w"> </span><span class="s2">&quot;+UVM_TESTNAME=test::base -uvmcontrol=all +UVM_MAX_QUIT_COUNT=1&quot;</span>
</pre></div>
</div>
<p>This command adds the OFM build source file which contains important macros for
processing the source files and running the verification:</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span><span class="w"> </span><span class="s2">&quot;$FIRMWARE_BASE/build/Modelsim.inc.fdo&quot;</span>
</pre></div>
</div>
<p>Now you can run the verification by passing the <em>*.fdo</em> file to the <strong>vsim -do</strong>
command. You can also run the verification in the command line (without GUI)
using the “-c” switch :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vsim<span class="w"> </span>-do<span class="w"> </span>top_level.fdo<span class="w"> </span>-c
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../ver.html" class="btn btn-neutral float-left" title="UVM Verification" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="sim_manual.html" class="btn btn-neutral float-right" title="UVM simulation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, CESNET z.s.p.o..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>